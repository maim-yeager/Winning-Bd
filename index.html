<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>WINNING BD</title>
    
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts: Lato + Hind Siliguri (Bengali Support) -->
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* =====================================================
           COMPLETE NEUMORPHIC + GLASSMORPHIC DESIGN SYSTEM
           EXACT UI MATCHING THE REFERENCE APP - FIXED VERSION
           + ALL NEW UPDATES: SPLASH, NETWORK, OFFLINE, REFER, UPDATE, ETC.
           ===================================================== */
        
        :root {
            --bg-primary: #e0e5ec;
            --bg-secondary: #f0f3f8;
            --light-shadow: #ffffff;
            --dark-shadow: #a3b1c6;
            --inset-shadow: #babecc;
            --primary: #1976D2;
            --primary-dark: #0D47A1;
            --primary-light: #42a5f5;
            --primary-gradient: linear-gradient(145deg, #1976D2, #0D47A1);
            --secondary: #ff9800;
            --secondary-dark: #f57c00;
            --secondary-light: #ffb74d;
            --secondary-gradient: linear-gradient(145deg, #ff9800, #f57c00);
            --success: #4CAF50;
            --success-dark: #2e7d32;
            --success-light: #81c784;
            --danger: #F44336;
            --danger-dark: #d32f2f;
            --danger-light: #ff8a80;
            --warning: #ff9800;
            --info: #29b6f6;
            --text-dark: #2d4059;
            --text-medium: #546e7a;
            --text-light: #78909c;
            --text-white: #ffffff;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.04);
            --bkash: #E2136E;
            --rocket: #8C3494;
            --nagad: #F7941D;
            --shadow-neumorphic: 12px 12px 24px var(--dark-shadow), -12px -12px 24px var(--light-shadow);
            --shadow-neumorphic-sm: 8px 8px 16px var(--dark-shadow), -8px -8px 16px var(--light-shadow);
            --shadow-neumorphic-inset: inset 8px 8px 16px var(--inset-shadow), inset -8px -8px 16px var(--light-shadow);
            --shadow-neumorphic-inset-sm: inset 4px 4px 8px var(--inset-shadow), inset -4px -4px 8px var(--light-shadow);
            --radius-xl: 30px;
            --radius-lg: 25px;
            --radius-md: 20px;
            --radius-sm: 15px;
            --radius-xs: 10px;
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --transition-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
            --transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-family: 'Lato', 'Hind Siliguri', sans-serif;
        }
        
        body {
            background: var(--bg-primary);
            color: var(--text-dark);
            min-height: 100vh;
            padding-bottom: 90px;
            position: relative;
            line-height: 1.5;
            overflow-x: hidden;
        }

        /* ===== EXIT CONFIRMATION MODAL (GLASS + ANIMATION) ===== */
        .exit-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .exit-modal.active {
            display: flex;
            opacity: 1;
        }
        .exit-modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            padding: 32px 24px;
            max-width: 380px;
            width: 100%;
            text-align: center;
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow-neumorphic), var(--glass-shadow);
            transform: scale(0.9);
            animation: modalPop 0.3s var(--transition-bounce) forwards;
        }
        @keyframes modalPop {
            to { transform: scale(1); }
        }
        .exit-modal-content i {
            font-size: 3.5rem;
            color: var(--warning);
            margin-bottom: 20px;
            filter: drop-shadow(0 4px 8px rgba(255,152,0,0.3));
        }
        .exit-modal-content h3 {
            font-size: 1.5rem;
            font-weight: 900;
            margin-bottom: 15px;
            color: var(--text-dark);
        }
        .exit-modal-content p {
            font-size: 1rem;
            color: var(--text-medium);
            margin-bottom: 30px;
            font-weight: 600;
        }
        .exit-modal-actions {
            display: flex;
            gap: 15px;
        }
        .exit-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 900;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .exit-btn.yes {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 8px 16px rgba(25,118,210,0.3);
        }
        .exit-btn.no {
            background: var(--bg-primary);
            color: var(--text-dark);
            box-shadow: var(--shadow-neumorphic-sm);
        }
        .exit-btn:active {
            transform: scale(0.95);
        }

        /* ===== NETWORK STATUS BAR ===== */
        #network-status-bar {
            position: sticky;
            top: 0;
            z-index: 2001;
            width: 100%;
            padding: 12px 20px;
            font-weight: 800;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            border-bottom: 1px solid var(--glass-border);
            backdrop-filter: blur(12px);
        }
        .status-online {
            background: var(--success);
            color: white;
        }
        .status-offline {
            background: var(--danger);
            color: white;
        }
        .network-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-left: 5px;
        }
        .indicator-online { background: var(--success); box-shadow: 0 0 10px var(--success); }
        .indicator-offline { background: var(--danger); box-shadow: 0 0 10px var(--danger); }

        /* ===== OFFLINE PAGE ===== */
        #offline-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            z-index: 10001;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--space-xl);
            text-align: center;
        }
        #offline-page.active { display: flex; }
        .offline-illustration {
            width: 200px;
            margin-bottom: 30px;
            opacity: 0.8;
        }

        /* ===== FORCED UPDATE OVERLAY ===== */
        .forced-update-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(10px);
            z-index: 20000;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: white;
            padding: 30px;
        }
        .forced-update-overlay.active { display: flex; }

        /* ===== RGB ANIMATION ===== */
        @keyframes rgbGlow {
            0% { color: #ff0000; text-shadow: 0 0 5px #ff0000; }
            20% { color: #ff9900; text-shadow: 0 0 5px #ff9900; }
            40% { color: #ffff00; text-shadow: 0 0 5px #ffff00; }
            60% { color: #33ff33; text-shadow: 0 0 5px #33ff33; }
            80% { color: #0099ff; text-shadow: 0 0 5px #0099ff; }
            100% { color: #ff33cc; text-shadow: 0 0 5px #ff33cc; }
        }
        .rgb-text {
            animation: rgbGlow 3s infinite;
            font-weight: 700;
        }

        /* ===== HOME PAGE LEFT SIDE APPS NAME ANIMATED ===== */
        @keyframes slideRightFade {
            0% { transform: translateX(-20px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        .animated-app-title {
            font-size: 1.6rem;
            font-weight: 900;
            background: linear-gradient(145deg, #1976D2, #0D47A1);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: slideRightFade 1s ee-out;
            letter-spacing: 1px;
            display: inline-block;
            margin-left: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .app-title-container {
            display: flex;
            align-items: center;
            padding: 15px 25px 0 25px;
            margin-bottom: 5px;
        }
        
        /* ===== CACHED BADGE ===== */
        .cached-badge {
            display: inline-block;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 0.7rem;
            font-weight: 700;
            color: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            margin-left: 8px;
            border: 1px solid rgba(255,255,255,0.3);
            vertical-align: middle;
        }
        .cat-card-img-wrapper, .slide, .mc-thumb {
            position: relative;
        }
        .badge-on-image {
            position: absolute;
            bottom: 6px;
            right: 6px;
            background: rgba(0,0,0,0.7);
            color: #fff;
            font-size: 0.65rem;
            padding: 3px 8px;
            border-radius: 20px;
            font-weight: 700;
            backdrop-filter: blur(2px);
            z-index: 10;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        /* ===== SPLASH SCREEN (ALWAYS SHOW FIRST) ===== */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #e0e5ec;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease;
            opacity: 1;
            visibility: visible;
        }
        .splash-logo-wrapper {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: var(--bg-primary);
            box-shadow: 12px 12px 24px #d1d9e6, -12px -12px 24px #ffffff, inset 2px 2px 4px #d1d9e6, inset -2px -2px 4px #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
            animation: zoomIn 1.5s ease;
        }
        .splash-logo {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }
        .splash-title {
            font-size: 2.5rem;
            font-weight: 900;
            margin-top: 30px;
            background: linear-gradient(145deg, #1976D2, #0D47A1);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            opacity: 0;
            animation: fadeInUp 1s 0.5s forwards;
        }
        .splash-version {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-medium);
            margin-top: 10px;
            opacity: 0;
            animation: fadeInUp 1s 0.8s forwards;
        }
        .splash-dev {
            font-size: 12px;
            margin-top: 15px;
            font-weight: 800;
            animation: rgbGlow 2s infinite;
        }
        @keyframes zoomIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        @keyframes fadeInUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* ===== PAGE TRANSITION ===== */
        .app-section {
            display: none;
            animation: slideFade 0.5s var(--transition-smooth);
        }
        .app-section.active {
            display: block;
        }
        @keyframes slideFade {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== REFER & EARN NEW CARD ===== */
        .refer-share-card {
            background: var(--primary-gradient);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin: 20px 0;
            color: white;
            box-shadow: var(--shadow-neumorphic);
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .refer-share-card:hover {
            transform: translateY(-5px);
        }
        .refer-share-card i {
            font-size: 2rem;
            background: white;
            padding: 12px;
            border-radius: 50%;
            color: var(--primary);
        }
        .update-banner {
            background: var(--secondary-gradient);
            padding: 16px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: white;
            font-weight: 900;
            margin-bottom: 20px;
        }
        .update-banner button {
            background: white;
            border: none;
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: 800;
            color: var(--secondary-dark);
            cursor: pointer;
        }
        
        /* ---------- ALL YOUR EXISTING STYLES (KEPT INTACT) ---------- */
        .tab-bar {
            position: fixed;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 95%;
            max-width: 500px;
            height: 75px;
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            border-radius: var(--radius-xl);
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow-neumorphic-sm), var(--glass-shadow);
            padding: 0 10px;
        }
        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 70px;
            height: 70px;
            color: var(--text-medium);
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: var(--radius-md);
        }
        .tab-icon-box {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-primary);
            box-shadow: var(--shadow-neumorphic-sm);
            transition: all 0.3s ease;
        }
        .tab-item.active .tab-icon-box {
            box-shadow: var(--shadow-neumorphic-inset-sm);
            transform: scale(0.95);
        }
        .tab-item i {
            font-size: 1.4rem;
            color: var(--text-dark);
        }
        .tab-item span {
            font-size: 0.7rem;
            margin-top: 6px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .tab-item.active span {
            color: var(--primary);
            font-weight: 900;
        }
        .tab-item.active i {
            color: var(--primary);
        }
        
        .fab-whatsapp {
            position: fixed;
            bottom: 170px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 20px;
            background: var(--bg-primary);
            box-shadow: var(--shadow-neumorphic-sm);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s var(--transition-bounce);
            z-index: 999;
            border: 1px solid var(--glass-border);
        }
        .fab-telegram {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 20px;
            background: var(--bg-primary);
            box-shadow: var(--shadow-neumorphic-sm);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s var(--transition-bounce);
            z-index: 999;
            border: 1px solid var(--glass-border);
        }
        .fab-whatsapp:hover, .fab-telegram:hover {
            transform: translateY(-8px) scale(1.1);
            box-shadow: var(--shadow-neumorphic);
        }
        .fab-whatsapp:active, .fab-telegram:active {
            transform: scale(0.95);
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .fab-whatsapp i {
            font-size: 32px;
            color: #25D366;
            filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.1));
        }
        .fab-telegram img {
            width: 32px;
            height: 32px;
        }
        
        .back-nav {
            padding: 20px 25px;
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 900;
            font-size: 1.1rem;
            color: var(--text-dark);
            cursor: pointer;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-neumorphic-sm);
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
            margin-bottom: var(--space-lg);
        }
        .back-nav i {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        
        .hero-banner {
            margin-bottom: var(--space-lg);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-neumorphic);
            position: relative;
        }
        .slider-container {
            width: 100%;
            padding-bottom: 56.25%;
            position: relative;
            overflow: hidden;
        }
        .slider-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            transition: transform 0.5s ease;
        }
        .slide {
            min-width: 100%;
            height: 100%;
            cursor: pointer;
            position: relative;
        }
        .slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .slider-dots {
            position: absolute;
            bottom: 15px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 8px;
            z-index: 10;
        }
        .dot {
            width: 10px;
            height: 10px;
            background: rgba(255,255,255,0.5);
            border-radius: 50%;
            transition: all 0.3s;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .dot.active {
            background: var(--secondary);
            width: 25px;
            border-radius: 12px;
            box-shadow: 0 0 10px rgba(255,152,0,0.5);
        }
        
        /* ===== FIXED MARQUEE - RIGHT TO LEFT, INFINITE, SMOOTH, DYNAMIC ===== */
        .marquee-container {
            background: var(--bg-primary);
            padding: 12px 20px;
            border-radius: var(--radius-md);
            margin: 0 var(--space-lg) var(--space-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: var(--shadow-neumorphic-inset-sm);
            overflow: hidden;
            position: relative;
            height: 52px;
        }
        .marquee-icon {
            color: var(--secondary);
            font-size: 18px;
            min-width: 24px;
            z-index: 2;
        }
        .marquee-wrapper {
            flex: 1;
            overflow: hidden;
            position: relative;
            height: 100%;
            display: flex;
            align-items: center;
        }
        .marquee-content {
            display: inline-block;
            white-space: nowrap;
            animation: marquee 25s linear infinite;
            font-weight: 700;
            font-size: 14px;
            color: var(--text-dark);
            padding-right: 50px;
        }
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        /* Pause on hover (optional) */
        .marquee-wrapper:hover .marquee-content {
            animation-play-state: paused;
        }
        
        .category-title {
            font-weight: 900;
            font-size: 1.4rem;
            margin: var(--space-xl) 0 var(--space-lg);
            text-align: center;
            color: var(--text-dark);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            padding-bottom: 10px;
        }
        .category-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--primary-gradient);
            border-radius: 2px;
        }
        .category-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr) !important;
            gap: 20px;
            padding: 0 var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        .cat-card {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-neumorphic-sm);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s var(--transition-bounce);
            border: 1px solid var(--glass-border);
        }
        .cat-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-neumorphic);
        }
        .cat-card:active {
            transform: scale(0.98);
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .cat-card-img {
            width: 100%;
            height: 110px;
            object-fit: cover;
            display: block;
        }
        .cat-card-info {
            padding: 10px;
            text-align: center;
        }
        .cat-card-title {
            font-weight: 900;
            font-size: 1rem;
            color: var(--text-dark);
            margin-bottom: 5px;
            text-transform: uppercase;
        }
        .cat-card-count {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-medium);
        }
        
        .match-card {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-neumorphic);
            margin: 0 var(--space-lg) var(--space-lg);
            overflow: hidden;
            transition: all 0.3s var(--transition-smooth);
            border: 1px solid var(--glass-border);
        }
        .match-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-neumorphic), 0 10px 30px rgba(0,0,0,0.1);
        }
        .mc-header {
            display: flex;
            padding: 20px;
            gap: 15px;
            background: linear-gradient(145deg, rgba(25,118,210,0.05), rgba(13,71,161,0.02));
            border-bottom: 1px solid var(--glass-border);
        }
        .mc-thumb {
            width: 100px;
            height: 65px;
            border-radius: var(--radius-md);
            object-fit: cover;
            box-shadow: var(--shadow-neumorphic-sm);
        }
        .mc-header-info {
            flex: 1;
        }
        .mc-title {
            font-weight: 900;
            font-size: 1rem;
            color: var(--text-dark);
            margin-bottom: 5px;
            line-height: 1.4;
        }
        .mc-time {
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--danger);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .mc-stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            padding: 20px;
        }
        .mc-stat-box {
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            padding: 12px;
            text-align: center;
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .mc-stat-label {
            font-size: 0.65rem;
            font-weight: 900;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }
        .mc-stat-value {
            font-size: 0.9rem;
            font-weight: 900;
            color: var(--text-dark);
        }
        .mc-progress-container {
            padding: 0 20px 20px;
        }
        .mc-prog-bar {
            height: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
            box-shadow: var(--shadow-neumorphic-inset-sm);
            overflow: hidden;
        }
        .mc-prog-fill {
            height: 100%;
            background: var(--success);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        .mc-spots-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--text-medium);
            margin-top: 8px;
        }
        .mc-btn-row {
            display: flex;
            gap: 12px;
            padding: 0 20px 20px;
            flex-wrap: wrap;
        }
        .btn-details {
            background: var(--bg-primary);
            padding: 12px 20px;
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            font-weight: 800;
            color: var(--primary);
            box-shadow: var(--shadow-neumorphic-sm);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            justify-content: center;
        }
        .btn-join {
            background: var(--primary-gradient);
            padding: 12px 24px;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: 900;
            color: white;
            box-shadow: 0 8px 16px rgba(25,118,210,0.3);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            justify-content: center;
        }
        .btn-join:active {
            transform: scale(0.96);
            box-shadow: 0 4px 8px rgba(25,118,210,0.4);
        }
        .btn-joined {
            background: linear-gradient(145deg, #e0e5ec, #d0d5e0);
            color: var(--text-light);
            pointer-events: none;
            opacity: 0.7;
        }
        .mc-footer-timer {
            background: var(--success);
            color: white;
            text-align: center;
            padding: 12px;
            font-size: 0.8rem;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
        }
        
        .match-tabs-container {
            display: flex;
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            padding: 4px;
            margin: 0 var(--space-lg) var(--space-lg);
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .m-tab {
            flex: 1;
            text-align: center;
            padding: 12px;
            font-weight: 800;
            font-size: 0.8rem;
            color: var(--text-light);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
        }
        .m-tab.active {
            background: var(--bg-primary);
            color: var(--primary);
            box-shadow: var(--shadow-neumorphic-sm);
        }
        
        .khelo-wallet-card {
            background: linear-gradient(145deg, #667eea, #764ba2);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin: 0 var(--space-lg) var(--space-lg);
            color: white;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-neumorphic);
        }
        .khelo-wallet-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://i.ibb.co.com/PGM77nTg/20260202-082654.jpg');
            background-size: cover;
            opacity: 0.1;
            mix-blend-mode: overlay;
        }
        .wallet-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.2rem;
            font-weight: 900;
            margin-bottom: var(--space-xl);
            position: relative;
            z-index: 2;
        }
        .wallet-card-header img {
            width: 50px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
        }
        .wallet-text {
            font-weight: 600;
            opacity: 0.9;
        }
        .wallet-balance-section {
            margin: var(--space-xl) 0;
            position: relative;
            z-index: 2;
        }
        .balance-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: var(--space-xs);
            font-weight: 700;
        }
        .balance-amount {
            font-size: 3.2rem;
            font-weight: 900;
            line-height: 1;
            letter-spacing: 1px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .wallet-valid-thru {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            opacity: 0.8;
            letter-spacing: 1px;
            position: relative;
            z-index: 2;
        }
        .wallet-stats-container {
            display: flex;
            gap: 20px;
            margin: 0 var(--space-lg) var(--space-lg);
        }
        .wallet-stat-box {
            flex: 1;
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow-neumorphic-sm);
            border: 1px solid var(--glass-border);
        }
        .stat-icon {
            font-size: 2rem;
            margin-bottom: var(--space-sm);
            color: var(--primary);
        }
        .stat-title {
            font-size: 0.8rem;
            font-weight: 900;
            color: var(--text-light);
            text-transform: uppercase;
            margin-bottom: var(--space-xs);
        }
        .stat-title.winning {
            color: var(--success);
        }
        .stat-amount {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--text-dark);
        }
        .wallet-actions {
            display: flex;
            gap: 20px;
            margin: 0 var(--space-lg) var(--space-lg);
        }
        .wallet-action-btn {
            flex: 1;
            padding: 18px;
            border-radius: var(--radius-lg);
            border: none;
            font-size: 1rem;
            font-weight: 900;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.2s var(--transition-bounce);
        }
        .btn-add-money {
            background: var(--primary-gradient);
            box-shadow: 0 8px 16px rgba(25,118,210,0.3);
        }
        .btn-withdraw {
            background: var(--success);
            box-shadow: 0 8px 16px rgba(76,175,80,0.3);
        }
        .wallet-action-btn:active {
            transform: scale(0.96);
        }
        .wallet-list-container {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            margin: 0 var(--space-lg) var(--space-lg);
            padding: var(--space-md);
            box-shadow: var(--shadow-neumorphic-sm);
            border: 1px solid var(--glass-border);
        }
        .wallet-list-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: var(--space-md);
            font-weight: 900;
            color: var(--text-dark);
            border-bottom: 2px solid rgba(25,118,210,0.1);
            margin-bottom: var(--space-sm);
        }
        .wallet-list-item {
            display: flex;
            align-items: center;
            padding: 18px 15px;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: var(--radius-md);
        }
        .wallet-list-item:hover {
            background: rgba(25,118,210,0.05);
            transform: translateX(8px);
        }
        .wallet-list-item:active {
            background: var(--bg-primary);
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .wallet-list-icon {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            color: var(--primary);
            margin-right: 15px;
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .wallet-list-text {
            flex: 1;
        }
        .wallet-list-text .title {
            font-weight: 900;
            color: var(--text-dark);
            margin-bottom: 4px;
        }
        .wallet-list-text .subtitle {
            font-size: 0.8rem;
            color: var(--text-light);
            font-weight: 600;
        }
        .wallet-list-arrow {
            color: var(--text-light);
            font-size: 1.2rem;
        }
        .pay-method-tabs-v2 {
            display: flex;
            justify-content: center;
            gap: 15px;
            padding: 25px 20px;
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            margin: 0 var(--space-lg) var(--space-lg);
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .pay-tab-v2 {
            padding: 15px;
            border-radius: var(--radius-md);
            background: var(--bg-primary);
            box-shadow: var(--shadow-neumorphic-sm);
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        .pay-tab-v2.active {
            border-color: var(--primary);
            box-shadow: var(--shadow-neumorphic-inset-sm);
            transform: translateY(-3px);
        }
        .pay-tab-v2 img {
            height: 35px;
            display: block;
        }
        .payment-content-box {
            display: none;
        }
        .payment-content-box.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        .deposit-form-container {
            margin: 0 var(--space-lg) var(--space-lg);
            padding: var(--space-xl);
            border-radius: var(--radius-xl);
            color: white;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-neumorphic);
        }
        .deposit-form-container.bkash { background: var(--bkash); }
        .deposit-form-container.nagad { background: var(--nagad); }
        .deposit-form-container.rocket { background: var(--rocket); }
        .deposit-form-title {
            font-size: 1.4rem;
            font-weight: 900;
            text-align: center;
            margin-bottom: var(--space-xl);
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .deposit-form-input {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: var(--radius-md);
            margin-bottom: var(--space-lg);
            font-size: 1rem;
            text-align: center;
            background: rgba(255,255,255,0.95);
            font-weight: 700;
            color: var(--text-dark);
        }
        .instruction-list {
            list-style: none;
            margin-bottom: var(--space-lg);
        }
        .instruction-list li {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 0.8rem;
            line-height: 1.6;
            background: rgba(255,255,255,0.1);
            padding: 12px 15px;
            border-radius: var(--radius-md);
            backdrop-filter: blur(5px);
        }
        .instruction-list li::before {
            content: 'âœ“';
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }
        .bkash .instruction-list li::before { color: var(--bkash); }
        .nagad .instruction-list li::before { color: var(--nagad); }
        .rocket .instruction-list li::before { color: var(--rocket); }
        .deposit-number-box {
            background: rgba(255,255,255,0.95);
            padding: 15px;
            border-radius: var(--radius-md);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .deposit-number-text {
            font-weight: 900;
            font-size: 1.1rem;
            letter-spacing: 1px;
        }
        .bkash .deposit-number-text { color: var(--bkash); }
        .nagad .deposit-number-text { color: var(--nagad); }
        .rocket .deposit-number-text { color: var(--rocket); }
        .btn-copy-v2 {
            padding: 10px 20px;
            background: var(--bg-primary);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 900;
            font-size: 0.8rem;
            cursor: pointer;
            box-shadow: var(--shadow-neumorphic-sm);
            color: var(--text-dark);
        }
        .btn-copy-v2:active {
            box-shadow: var(--shadow-neumorphic-inset-sm);
            transform: scale(0.95);
        }
        .btn-verify-v2 {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 900;
            font-size: 1.1rem;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .btn-verify-v2:active {
            transform: scale(0.98);
            box-shadow: inset 0 4px 8px rgba(0,0,0,0.1);
        }
        .bkash .btn-verify-v2 { color: var(--bkash); }
        .nagad .btn-verify-v2 { color: var(--nagad); }
        .rocket .btn-verify-v2 { color: var(--rocket); }
        .withdraw-container {
            padding: 0 var(--space-lg);
        }
        .withdraw-card {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            box-shadow: var(--shadow-neumorphic-sm);
            border: 1px solid var(--glass-border);
        }
        .balance-card {
            text-align: center;
            background: linear-gradient(145deg, rgba(76,175,80,0.1), rgba(46,125,50,0.05));
        }
        .balance-card img {
            width: 70px;
            margin-bottom: 15px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }
        .balance-card h2 {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--text-dark);
        }
        .method-options {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        .method-btn {
            flex: 1;
            padding: 15px;
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            box-shadow: var(--shadow-neumorphic-sm);
        }
        .method-btn.active {
            border-color: var(--success);
            box-shadow: var(--shadow-neumorphic-inset-sm);
            transform: scale(0.95);
        }
        .method-btn img {
            height: 30px;
            display: block;
            margin: 0 auto;
        }
        .input-group-v2 {
            display: flex;
            align-items: center;
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            padding: 0 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .input-group-v2 i {
            color: var(--text-light);
            margin-right: 12px;
        }
        .input-group-v2 input {
            flex: 1;
            background: transparent;
            border: none;
            padding: 18px 10px;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-dark);
            outline: none;
        }
        .min-withdraw-notice {
            background: rgba(255,152,0,0.1);
            border: 1px solid var(--secondary);
            color: var(--secondary);
            padding: 15px;
            border-radius: var(--radius-md);
            text-align: center;
            font-weight: 900;
            margin: 0 var(--space-lg) var(--space-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .withdraw-submit-btn {
            width: 100%;
            padding: 20px;
            background: var(--success);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            font-size: 1.2rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 8px 16px rgba(76,175,80,0.3);
            margin-bottom: 30px;
        }
        .withdraw-submit-btn:active {
            transform: scale(0.96);
            box-shadow: 0 4px 8px rgba(76,175,80,0.4);
        }
        .glassmorphic {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin: 0 var(--space-lg) var(--space-lg);
            box-shadow: var(--shadow-neumorphic);
            border: 1px solid var(--glass-border);
        }
        .refer-code-display {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: var(--radius-md);
            font-size: 2.2rem;
            font-weight: 900;
            letter-spacing: 4px;
            margin: 20px 0;
            border: 2px dashed var(--primary);
            color: var(--text-dark);
            text-align: center;
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .primary-btn {
            width: 100%;
            padding: 16px;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 900;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 8px 16px rgba(25,118,210,0.3);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .primary-btn:active {
            transform: scale(0.96);
        }
        .primary-btn:disabled {
            opacity: 0.6;
            transform: none;
            pointer-events: none;
        }
        .refer-step {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            margin-bottom: 15px;
            box-shadow: var(--shadow-neumorphic-sm);
            border: 1px solid var(--glass-border);
        }
        .step-icon {
            width: 50px;
            height: 50px;
            background: var(--primary-gradient);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 900;
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        .dev-profile-card {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin: 0 var(--space-lg) var(--space-lg);
            box-shadow: var(--shadow-neumorphic);
            border: 1px solid var(--glass-border);
            text-align: center;
        }
        .dev-title {
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: var(--space-lg);
            color: var(--text-dark);
        }
        .dev-features {
            list-style: none;
            text-align: left;
            margin: var(--space-xl) 0;
        }
        .dev-features li {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255,255,255,0.5);
            border-radius: var(--radius-md);
            font-weight: 700;
        }
        .dev-features i {
            color: var(--success);
            font-size: 1.2rem;
        }
        .dev-contact-btn {
            display: inline-block;
            padding: 16px 32px;
            background: var(--primary-gradient);
            color: white;
            border-radius: var(--radius-md);
            font-weight: 900;
            font-size: 1.2rem;
            text-decoration: none;
            margin-top: var(--space-lg);
            box-shadow: 0 8px 16px rgba(25,118,210,0.3);
        }
        .profile-header-bg {
            background: var(--primary-gradient);
            padding: 50px 20px 30px;
            text-align: center;
            color: white;
            margin-bottom: 25px;
            border-radius: 0 0 30px 30px;
            position: relative;
            overflow: hidden;
        }
        .profile-avatar-box {
            width: 100px;
            height: 100px;
            margin: 0 auto 15px;
        }
        .profile-avatar-box img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid rgba(255,255,255,0.8);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }
        #profile-name {
            font-size: 1.5rem;
            font-weight: 900;
            margin-top: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        #profile-email {
            opacity: 0.9;
            font-size: 0.9rem;
            margin-bottom: 25px;
            font-weight: 600;
        }
        .balance-display {
            display: flex;
            justify-content: center;
            gap: 40px;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            margin: 0 20px;
        }
        .balance-item {
            text-align: center;
        }
        .balance-item .balance-label {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        .balance-item .balance-amount {
            font-weight: 900;
            font-size: 1.5rem;
        }
        .menu-list {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            margin: 0 var(--space-lg) var(--space-lg);
            overflow: hidden;
            box-shadow: var(--shadow-neumorphic-sm);
            border: 1px solid var(--glass-border);
        }
        .menu-item {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            color: var(--text-dark);
            font-weight: 700;
            transition: all 0.2s;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .menu-item:last-child {
            border-bottom: none;
        }
        .menu-item:hover {
            background: rgba(25,118,210,0.05);
            transform: translateX(8px);
        }
        .menu-item:active {
            background: var(--bg-primary);
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .menu-item img {
            width: 24px;
            height: 24px;
            filter: none;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: var(--space-lg);
        }
        .modal.active {
            display: flex;
            animation: fadeIn 0.3s;
        }
        .modal-box {
            width: 100%;
            max-width: 400px;
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            box-shadow: var(--shadow-neumorphic);
            position: relative;
            border: 1px solid var(--glass-border);
        }
        .popup-close-btn {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 35px;
            height: 35px;
            background: var(--bg-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            cursor: pointer;
            box-shadow: var(--shadow-neumorphic-sm);
            border: 1px solid var(--glass-border);
        }
        .limit-icon {
            font-size: 3.5rem;
            color: var(--warning);
            margin-bottom: 20px;
        }
        .warning-join-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: var(--radius-md);
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 6px 12px rgba(25,118,210,0.3);
        }
        #toast-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: auto;
            max-width: 90vw;
            pointer-events: none;
        }
        .toast {
            padding: 16px 24px;
            border-radius: var(--radius-md);
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            box-shadow: var(--shadow-neumorphic);
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            color: var(--text-dark);
            border-left: 6px solid transparent;
            animation: slideInToast 0.3s;
        }
        .toast.success { border-left-color: var(--success); }
        .toast.error { border-left-color: var(--danger); }
        .toast.warning { border-left-color: var(--warning); }
        @keyframes slideInToast {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ===== FIXED AUTH UI WITH PASSWORD TOGGLE ===== */
        #auth-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-xl);
            overflow-y: auto;
            visibility: hidden; /* Hidden by default - will be shown after splash if not logged in */
        }
        .auth-page {
            width: 100%;
            max-width: 480px;
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            box-shadow: var(--shadow-neumorphic);
            display: none;
        }
        .auth-page.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        .auth-back-arrow {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-md);
            background: var(--bg-primary);
            box-shadow: var(--shadow-neumorphic-sm);
            cursor: pointer;
            margin-bottom: var(--space-lg);
        }
        .auth-header .title {
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 10px;
            color: var(--text-dark);
            text-align: center;
        }
        .auth-header .subtitle {
            font-size: 1rem;
            color: var(--text-medium);
            margin-bottom: 40px;
            text-align: center;
            font-weight: 600;
        }
        .auth-form-title {
            font-size: 1.6rem;
            font-weight: 900;
            margin-bottom: 30px;
            color: var(--text-dark);
            text-align: center;
        }
        .auth-input {
            width: 100%;
            background: var(--bg-primary);
            border: none;
            border-radius: var(--radius-md);
            padding: 18px;
            font-size: 1rem;
            color: var(--text-dark);
            outline: none;
            box-shadow: var(--shadow-neumorphic-inset-sm);
            font-weight: 600;
            margin-bottom: 20px;
        }
        .auth-input.error {
            border: 2px solid var(--danger);
            box-shadow: 0 0 0 2px rgba(244,67,54,0.2);
        }
        .auth-error-message {
            color: var(--danger);
            font-size: 0.8rem;
            font-weight: 700;
            margin-top: -15px;
            margin-bottom: 15px;
            padding-left: 5px;
            display: none;
        }
        .auth-error-message.active {
            display: block;
        }
        
        /* ===== PASSWORD TOGGLE WRAPPER ===== */
        .password-input-wrapper {
            position: relative;
            width: 100%;
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-neumorphic-inset-sm);
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .password-input-wrapper input {
            flex: 1;
            background: transparent;
            border: none;
            padding: 18px;
            font-size: 1rem;
            color: var(--text-dark);
            outline: none;
            font-weight: 600;
        }
        .password-toggle-btn {
            padding: 0 18px;
            color: var(--text-light);
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        .password-toggle-btn:hover {
            color: var(--primary);
        }
        
        .promo-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
        }
        .promo-group input {
            flex: 1;
            margin-bottom: 0;
        }
        .promo-verify-btn {
            padding: 0 25px;
            background: var(--bg-primary);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 900;
            color: var(--primary-dark);
            height: 54px;
            cursor: pointer;
            white-space: nowrap;
            box-shadow: var(--shadow-neumorphic-sm);
            border: 1px solid var(--glass-border);
        }
        .promo-verify-btn:active {
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .promo-success {
            color: var(--success);
            font-size: 0.8rem;
            margin-top: -15px;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .promo-error {
            color: var(--danger);
            font-size: 0.8rem;
            margin-top: -15px;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .auth-checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 25px;
            font-size: 0.9rem;
            color: var(--text-medium);
            background: var(--bg-primary);
            padding: 16px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .auth-checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: var(--primary);
            cursor: pointer;
            margin-top: 2px;
        }
        .auth-checkbox-group label {
            line-height: 1.4;
            cursor: pointer;
            flex: 1;
        }
        .auth-btn {
            width: 100%;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            padding: 18px;
            font-size: 1.1rem;
            font-weight: 900;
            cursor: pointer;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.2s;
            box-shadow: 0 8px 16px rgba(25,118,210,0.3);
        }
        .auth-btn:active {
            transform: scale(0.98);
        }
        .auth-btn:disabled {
            opacity: 0.7;
            transform: none;
            pointer-events: none;
        }
        .auth-link {
            color: var(--secondary);
            font-weight: 700;
            text-align: center;
            display: block;
            margin-bottom: 20px;
            font-size: 0.9rem;
            cursor: pointer;
        }
        .auth-switch-text {
            text-align: center;
            color: var(--text-medium);
            font-size: 0.95rem;
            font-weight: 600;
            padding: 20px;
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-neumorphic-inset-sm);
        }
        .auth-switch-text span {
            color: var(--primary);
            font-weight: 900;
            cursor: pointer;
        }
        .hidden {
            display: none !important;
        }
        .fade-image {
            animation: fadeImage 0.8s ease;
        }
        @keyframes fadeImage {
            from { opacity: 0.6; }
            to { opacity: 1; }
        }
        @media (max-width: 768px) {
            .wallet-stats-container {
                flex-direction: column;
            }
            .wallet-actions {
                flex-direction: column;
            }
            .mc-btn-row {
                flex-direction: column;
            }
            .method-options {
                flex-direction: column;
            }
            .mc-stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (max-width: 480px) {
            .balance-amount {
                font-size: 2.5rem;
            }
            .tab-bar {
                width: 90%;
                height: 70px;
            }
            .marquee-container {
                height: 48px;
                padding: 8px 15px;
            }
            .marquee-content {
                animation: marquee 20s linear infinite;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>

<!-- ===== EXIT CONFIRMATION MODAL (BENGALI) ===== -->
<div id="exit-modal" class="exit-modal">
    <div class="exit-modal-content">
        <i class="fas fa-sign-out-alt"></i>
        <h3>à¦†à¦ªà¦¨à¦¿ à¦•à¦¿ à¦…à§à¦¯à¦¾à¦ªà¦¸ à¦¥à§‡à¦•à§‡ à¦¬à§‡à¦° à¦¹à¦¬à§‡à¦¨?</h3>
        <p>à¦†à¦ªà¦¨à¦¿ à¦•à¦¿ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤à¦­à¦¾à¦¬à§‡ à¦ªà§à¦°à¦¸à§à¦¥à¦¾à¦¨ à¦•à¦°à¦¤à§‡ à¦šà¦¾à¦¨?</p>
        <div class="exit-modal-actions">
            <button class="exit-btn yes" onclick="exitAppConfirmed()">âœ… à¦¹à§à¦¯à¦¾à¦</button>
            <button class="exit-btn no" onclick="closeExitModal()">âŒ à¦¨à¦¾</button>
        </div>
    </div>
</div>

<!-- ========== NETWORK STATUS BAR ========== -->
<div id="network-status-bar" class="status-online" style="display: none;">
    <i class="fas fa-wifi"></i> âœ“ à¦†à¦ªà¦¨à¦¿ à¦…à¦¨à¦²à¦¾à¦‡à¦¨à§‡ à¦†à¦›à§‡à¦¨
    <span id="network-indicator-dot" class="network-indicator indicator-online"></span>
</div>

<!-- ========== OFFLINE PAGE ========== -->
<div id="offline-page">
    <img src="https://i.ibb.co.com/whcG0rC6/1770787659213-8d48fc16-a270-4efc-bbcd-e737bcbcd6c6.png" class="offline-illustration" alt="offline">
    <h2 style="color: var(--text-dark); margin-bottom: 20px;">à¦‡à¦¨à§à¦Ÿà¦¾à¦°à¦¨à§‡à¦Ÿ à¦¸à¦‚à¦¯à§‹à¦— à¦¨à§‡à¦‡</h2>
    <p style="color: var(--text-medium); margin-bottom: 30px;">à¦†à¦ªà¦¨à¦¿ à¦…à¦«à¦²à¦¾à¦‡à¦¨à§‡ à¦†à¦›à§‡à¦¨à¥¤ à¦¸à¦‚à¦¯à§‹à¦— à¦«à¦¿à¦°à§‡ à¦à¦²à§‡ à¦¸à§à¦¬à¦¯à¦¼à¦‚à¦•à§à¦°à¦¿à¦¯à¦¼à¦­à¦¾à¦¬à§‡ à¦ªà§à¦¨à¦°à¦¾à¦¯à¦¼ à¦¸à¦‚à¦¯à§à¦•à§à¦¤ à¦¹à¦¬à§‡à¥¤</p>
    <div style="background: var(--bg-primary); padding: 20px; border-radius: var(--radius-md); box-shadow: var(--shadow-neumorphic-inset);">
        <i class="fas fa-sync-alt" style="color: var(--primary);"></i> à¦ªà§à¦¨à¦°à¦¾à¦¯à¦¼ à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦¹à¦šà§à¦›à§‡...
    </div>
</div>

<!-- ========== FORCED UPDATE OVERLAY ========== -->
<div id="forced-update-overlay" class="forced-update-overlay">
    <i class="fas fa-download" style="font-size: 4rem; margin-bottom: 20px; color: var(--secondary);"></i>
    <h2 style="margin-bottom: 15px;">à¦¨à¦¤à§à¦¨ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦à¦¸à§‡à¦›à§‡!</h2>
    <p style="margin-bottom: 25px; text-align: center; max-width: 300px;" id="forced-update-msg">à¦…à§à¦¯à¦¾à¦ª à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¾ à¦†à¦¬à¦¶à§à¦¯à¦•à¥¤</p>
    <a href="#" id="forced-update-link" target="_blank" style="background: var(--primary-gradient); padding: 16px 40px; border-radius: 50px; color: white; font-weight: 900; text-decoration: none;">à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à§à¦¨</a>
</div>

<!-- ========== SPLASH SCREEN (ALWAYS FIRST) ========== -->
<div id="splash-screen">
    <div class="splash-logo-wrapper">
        <img src="https://i.ibb.co.com/whcG0rC6/1770787659213-8d48fc16-a270-4efc-bbcd-e737bcbcd6c6.png" alt="WINNING BD Logo" class="splash-logo" id="splash-logo-img">
    </div>
    <h1 class="splash-title">WINNING TOUR</h1>
    <p class="splash-version">3.0</p>
    <div class="splash-dev rgb-text">Dev Maim</div>
</div>

<!-- ========== TOAST CONTAINER ========== -->
<div id="toast-container"></div>

<!-- ========== FLOATING ACTION BUTTONS ========== -->
<div class="fab-whatsapp" onclick="window.open('https://wa.me/8801712345678?text=Hello%20WINNING%20BD%20Support', '_blank')">
    <i class="fab fa-whatsapp"></i>
</div>
<div class="fab-telegram" onclick="window.open('https://t.me/cr_maim', '_blank')">
    <img src="https://img.icons8.com/?size=100&id=yjJvTQzQoKEy&format=png&color=000000" alt="Telegram">
</div>

<!-- ========== MAIN CONTENT ========== -->
<main id="main-content">

    <!-- ========== HOME SECTION ========== -->
    <section id="tab-home-view" class="app-section">
        <div class="app-title-container">
            <span class="animated-app-title">âš¡WINNING BD</span>
        </div>
        <div class="hero-banner">
            <div class="slider-container">
                <div id="banner-slider-wrapper" class="slider-wrapper"></div>
            </div>
            <div id="slider-dots" class="slider-dots"></div>
        </div>
        
        <div class="home-content-wrapper">
            <!-- FIXED MARQUEE - RIGHT TO LEFT, INFINITE, SMOOTH, DYNAMIC -->
            <div class="marquee-container">
                <i class="fas fa-bullhorn marquee-icon"></i>
                <div class="marquee-wrapper">
                    <span id="dynamic-notice" class="marquee-content">Welcome to WINNING BD - Bangladesh's Largest Tournament Platform</span>
                </div>
            </div>
            
            <div class="category-title">FREE FIRE & OTHERS</div>
            
            <div id="dynamic-category-list" class="category-grid"></div>
        </div>
    </section>

    <!-- ========== MY MATCHES SECTION ========== -->
    <section id="tab-mymatches-view" class="app-section">
        <div class="back-nav" onclick="showSection('home')">
            <i class="fas fa-arrow-left"></i>
            <span>MY MATCHES</span>
        </div>
        <div id="mymatches-container"></div>
    </section>

    <!-- ========== RESULT SECTION ========== -->
    <section id="tab-result-view" class="app-section">
        <div class="back-nav" onclick="showSection('home')">
            <i class="fas fa-arrow-left"></i>
            <span>MATCH RESULTS</span>
        </div>
        <div id="result-container"></div>
    </section>

    <!-- ========== PROFILE SECTION ========== -->
    <section id="tab-profile-view" class="app-section">
        <div class="profile-header-bg">
            <div class="profile-avatar-box">
                <img id="profile-avatar" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Avatar" class="fade-image">
            </div>
            <h3 id="profile-name">Guest User</h3>
            <p id="profile-email">Please login to continue</p>
            
            <div class="balance-display">
                <div class="balance-item">
                    <div class="balance-label">Deposit</div>
                    <div class="balance-amount">à§³ <span id="profile-bal-dep">0</span></div>
                </div>
                <div class="balance-item">
                    <div class="balance-label">Winnings</div>
                    <div class="balance-amount">à§³ <span id="profile-bal-win">0</span></div>
                </div>
            </div>
        </div>
        
        <div style="padding: 0 20px;">
            <div class="menu-list">
                <div class="menu-item" onclick="navigateSub('wallet')">
                    <img src="https://img.icons8.com/?size=100&id=JeOIikeRv8rJ&format=png&color=000000" alt="Wallet">
                    <span>My Wallet</span>
                    <i class="fas fa-chevron-right" style="margin-left: auto; color: var(--text-light);"></i>
                </div>
                <div class="menu-item" onclick="navigateSub('edit-profile')">
                    <img src="https://img.icons8.com/?size=100&id=O6yJLWcR6TNz&format=png&color=000000" alt="Edit">
                    <span>Edit Profile</span>
                    <i class="fas fa-chevron-right" style="margin-left: auto; color: var(--text-light);"></i>
                </div>
                <div class="menu-item" onclick="navigateSub('refer')">
                    <img src="https://img.icons8.com/?size=100&id=mvX5rQmbiHy1&format=png&color=000000" alt="Refer">
                    <span>Refer & Earn</span>
                    <i class="fas fa-chevron-right" style="margin-left: auto; color: var(--text-light);"></i>
                </div>
                <div class="menu-item" onclick="navigateSub('history')">
                    <img src="https://img.icons8.com/?size=100&id=TF9VCgblG6vy&format=png&color=000000" alt="History">
                    <span>All Transactions</span>
                    <i class="fas fa-chevron-right" style="margin-left: auto; color: var(--text-light);"></i>
                </div>
                <div class="menu-item" onclick="navigateSub('notifications')">
                    <img src="https://img.icons8.com/?size=100&id=ds3fC4MMLVI6&format=png&color=000000" alt="Notifications">
                    <span>Notification</span>
                    <span id="menu-notif-badge" style="background: var(--danger); color: white; font-size: 0.7rem; padding: 2px 8px; border-radius: 20px; margin-left: auto; display: none;">0</span>
                </div>
                <div class="menu-item" onclick="navigateSub('developer-profile')">
                    <img src="https://img.icons8.com/?size=100&id=Aiy01hWHN0hk&format=png&color=000000" alt="Developer">
                    <span>Developer</span>
                    <i class="fas fa-chevron-right" style="margin-left: auto; color: var(--text-light);"></i>
                </div>
                
                <div id="profile-login-btn" class="menu-item" onclick="showAuthScreen()">
                    <i class="fas fa-sign-in-alt" style="color: var(--success); width: 24px;"></i>
                    <span style="color: var(--success);">Login / Register</span>
                </div>
                <div id="profile-logout-btn" class="menu-item hidden" onclick="logout()">
                    <i class="fas fa-sign-out-alt" style="color: var(--danger); width: 24px;"></i>
                    <span style="color: var(--danger);">Logout</span>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px; color: var(--text-light); font-size: 0.8rem; font-weight: 600; padding: 20px; background: var(--bg-primary); border-radius: var(--radius-lg); box-shadow: var(--shadow-neumorphic-inset-sm);">
                App Version 3.0 | WINNING BD
            </div>
        </div>
    </section>

    <!-- ========== MATCHES VIEW (CATEGORY) ========== -->
    <section id="matches-view" class="app-section">
        <div class="back-nav" onclick="showSection('home')">
            <i class="fas fa-arrow-left"></i>
            <span>Back to Home</span>
        </div>
        
        <div class="match-tabs-container">
            <div class="m-tab active" onclick="filterMatchTab('Upcoming')">Upcoming</div>
            <div class="m-tab" onclick="filterMatchTab('Ongoing')">On-Going</div>
            <div class="m-tab" onclick="filterMatchTab('Finished')">Result</div>
        </div>
        
        <div id="matches-container"></div>
    </section>

    <!-- ========== WALLET VIEW ========== -->
    <section id="wallet-view" class="app-section">
        <div class="back-nav" onclick="navigateBack('profile')">
            <i class="fas fa-arrow-left"></i>
            <span>MY WALLET</span>
        </div>
        
        <div class="khelo-wallet-card">
            <div class="wallet-card-header">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAACqElEQVR4nO2Zu0sVURjHv79N6x8IYlqIlRZvQguCoLK0CKKoCEp7G4miLbZpEVQ0tmkUERSTLMLKEBFRIaTSRd8Uu/d+5nF2Zmd2vjvzZu4DB+6de85vz5y53z1rVatWLzQCHYAF4BwwBnQCi8AY0Ak8AiPAE9APfAEew+YAk9YCi8AR8BlYAb5ZAGwCDcA+MAsstgCPgZfAZ6B+AjaB/cBRIOAc6ALnwCtwAgyB2sYEmAQeAHfAVmD/LbgvA5OBc+A+MLfA5gE/gTvgGfgNeAP2gMvA5mUBA8AwcAIYB84DPQBWYA14DNwAehTF7Q3cBu7X/B1gBfgbGE/sS4CZwEnsL74B7gCzQGfxkQIXgWfAsDqFwJbgC3ALrABbQJVFwI4yrx+F3QE2gddgf849wI7kPquA7cC6Ym8g0wKLAI+A3cBOYJ/ZdwE0gCvgOvAXqA0mge2l2hgwA3wCigS8vYBVYJLZv59BwDjwDPgJzM3gfLYWvAF3wAFQBHQAPcAwEAvgKaAHuAr8AhOBc+AyMLvY3gEuwO6c/V8K3gA7gSXgGfAAnAc6gKPAI/AF2AUuAo+Br4G/wBvgNfAWeA98B74HXgNfAa+A14DXwNvgffAV8Bp4DbwG3gNvgU/AafApuA0+BXfBp+A2+BTcBZ+B2+BTcBcMAWfAZ2AwM/5/AZOBs2BNs4/ATGCn5yvgE/AncAT8BT4CH4GvQJvLwL1gX7P+TgC7G/s+AvcB4/K6R/91LgIfgT7l/B3o09x/DvwB7AAnVwJ/gUvAN3C+FpgEDgPfVwBvAJeAJzUf007Af2nQpA1wBfgDLBcN3vUNeAQsLho8L0+BNcXC5w1fAS8AXgZeAN8f658L/GvB8/sL+AJYAI7/AXAAdAC3lq1a/Q+oR/l5fP/1bQAAAABJRU5ErkJggg==" alt="Card">
                <span>WINNING BD <span class="wallet-text">WALLET</span></span>
            </div>
            <div class="wallet-balance-section">
                <div class="balance-label">Available Balance</div>
                <div class="balance-amount">à§³ <span id="wallet-balance-display">0</span></div>
            </div>
            <div class="wallet-valid-thru">
                <span>VALID<br>THRU</span>
                <span>. . . . . . . . . . . .</span>
                <span>GAMING</span>
            </div>
        </div>
        
        <div class="wallet-stats-container">
            <div class="wallet-stat-box">
                <i class="fas fa-wallet stat-icon"></i>
                <div class="stat-title deposited">DEPOSITED</div>
                <div class="stat-amount">à§³ <span id="deposit-available-wallet">0</span></div>
            </div>
            <div class="wallet-stat-box">
                <i class="fas fa-trophy stat-icon" style="color: gold;"></i>
                <div class="stat-title winning">WINNING</div>
                <div class="stat-amount">à§³ <span id="withdraw-available-wallet">0</span></div>
            </div>
        </div>
        
        <div class="wallet-actions">
            <button class="wallet-action-btn btn-add-money" onclick="navigateSub('add-money')">
                <i class="fas fa-plus-circle"></i> Add Money
            </button>
            <button class="wallet-action-btn btn-withdraw" onclick="navigateSub('withdraw')">
                <i class="fas fa-paper-plane"></i> Withdraw
            </button>
        </div>
        
        <div class="wallet-list-container">
            <div class="wallet-list-header">
                <i class="fas fa-bolt" style="color: var(--primary);"></i>
                <span>QUICK ACTIONS</span>
            </div>
            <div class="wallet-list-item" onclick="navigateSub('history')">
                <div class="wallet-list-icon">
                    <i class="fas fa-history"></i>
                </div>
                <div class="wallet-list-text">
                    <div class="title">Transaction History</div>
                    <div class="subtitle">View all your transactions</div>
                </div>
                <i class="fas fa-chevron-right wallet-list-arrow"></i>
            </div>
        </div>
        
        <div class="wallet-list-container">
            <div class="wallet-list-header">
                <i class="fas fa-info-circle" style="color: var(--primary);"></i>
                <span>LEARN AND SUPPORT</span>
            </div>
            <div class="wallet-list-item" onclick="openVideo('addMoney')">
                <div class="wallet-list-icon" style="color: #9C27B0;">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div class="wallet-list-text">
                    <div class="title">How to add money?</div>
                    <div class="subtitle">à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦Ÿà¦¾à¦•à¦¾ à¦…à§à¦¯à¦¾à¦¡ à¦•à¦°à¦¬à§‡à¦¨</div>
                </div>
                <i class="fas fa-chevron-right wallet-list-arrow"></i>
            </div>
            <div class="wallet-list-item" onclick="openVideo('howPlay')">
                <div class="wallet-list-icon" style="color: #E91E63;">
                    <i class="fas fa-user-headset"></i>
                </div>
                <div class="wallet-list-text">
                    <div class="title">How to join a match?</div>
                    <div class="subtitle">à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦®à§à¦¯à¦¾à¦šà§‡ à¦œà§Ÿà§‡à¦¨ à¦•à¦°à¦¬à§‡à¦¨</div>
                </div>
                <i class="fas fa-chevron-right wallet-list-arrow"></i>
            </div>
            <div class="wallet-list-item" onclick="openVideo('getRoom')">
                <div class="wallet-list-icon" style="color: #FF9800;">
                    <i class="fas fa-users"></i>
                </div>
                <div class="wallet-list-text">
                    <div class="title">How to join in a room?</div>
                    <div class="subtitle">à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦°à§à¦®à§‡ à¦œà§Ÿà§‡à¦¨ à¦•à¦°à¦¬à§‡à¦¨</div>
                </div>
                <i class="fas fa-chevron-right wallet-list-arrow"></i>
            </div>
        </div>
    </section>

    <!-- ========== ADD MONEY VIEW ========== -->
    <section id="add-money-view" class="app-section">
        <div class="back-nav" onclick="navigateBack('wallet')">
            <i class="fas fa-arrow-left"></i>
            <span>ADD MONEY</span>
        </div>
        
        <div class="pay-method-tabs-v2">
            <div class="pay-tab-v2 active" onclick="switchPayTab('bkash')">
                <img src="https://i.ibb.co.com/qF1xD5xj/image-search-1769091253468.png" alt="bKash">
            </div>
            <div class="pay-tab-v2" onclick="switchPayTab('nagad')">
                <img src="https://i.ibb.co/4gmdTj1f/image-search-1769091285966.png" alt="Nagad">
            </div>
            <div class="pay-tab-v2" onclick="switchPayTab('rocket')">
                <img src="https://i.ibb.co/MDt4TzDf/image-search-1769091463880.png" alt="Rocket">
            </div>
        </div>
        
        <div id="content-bkash" class="payment-content-box active">
            <div class="deposit-form-container bkash">
                <h3 class="deposit-form-title">à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦†à¦‡à¦¡à¦¿ à¦¦à¦¿à¦¨</h3>
                <input type="text" id="trx-bkash" class="deposit-form-input" placeholder="à¦à¦–à¦¾à¦¨à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦†à¦‡à¦¡à¦¿ à¦²à¦¿à¦–à§à¦¨">
                <ul class="instruction-list">
                    <li>*247# à¦¡à¦¾à§Ÿà¦¾à¦² à¦•à¦°à§‡ à¦†à¦ªà¦¨à¦¾à¦° BKASH à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦®à§‡à¦¨à§à¦¤à§‡ à¦¯à¦¾à¦¨ à¦…à¦¥à¦¬à¦¾ BKASH à¦…à§à¦¯à¦¾à¦ªà§‡ à¦¯à¦¾à¦¨à¥¤</li>
                    <li><strong>Send Money/Make Payment</strong> - à¦ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨à¥¤</li>
                    <li>à¦ªà§à¦°à¦¾à¦ªà¦• à¦¨à¦®à§à¦¬à¦° à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦¨à¦¿à¦šà§‡à¦° à¦à¦‡ à¦¨à¦®à§à¦¬à¦°-à¦Ÿà¦¿ à¦²à¦¿à¦–à§à¦¨</li>
                </ul>
                <div class="deposit-number-box">
                    <span id="bkash-num-display" class="deposit-number-text">Loading...</span>
                    <button class="btn-copy-v2" onclick="copyToClipboard('bkash-num-display')">COPY</button>
                </div>
                <ul class="instruction-list">
                    <li>à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à¦¤à§‡ à¦à¦–à¦¨ à¦†à¦ªà¦¨à¦¾à¦° BKASH à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦®à§‡à¦¨à§ à¦ªà¦¿à¦¨ à¦²à¦¿à¦–à§à¦¨à¥¤</li>
                    <li>à¦à¦–à¦¨ à¦‰à¦ªà¦°à§‡à¦° à¦¬à¦•à§à¦¸à§‡ à¦†à¦ªà¦¨à¦¾à¦° Transaction ID à¦¦à¦¿à¦¨ à¦à¦¬à¦‚ VERIFY à¦¬à¦¾à¦Ÿà¦¨à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨à¥¤</li>
                </ul>
                <button class="btn-verify-v2" onclick="verifyAutoPay('bkash')">VERIFY</button>
            </div>
        </div>
        
        <div id="content-nagad" class="payment-content-box">
            <div class="deposit-form-container nagad">
                <h3 class="deposit-form-title">à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦†à¦‡à¦¡à¦¿ à¦¦à¦¿à¦¨</h3>
                <input type="text" id="trx-nagad" class="deposit-form-input" placeholder="à¦à¦–à¦¾à¦¨à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦†à¦‡à¦¡à¦¿ à¦²à¦¿à¦–à§à¦¨">
                <ul class="instruction-list">
                    <li>*167# à¦¡à¦¾à§Ÿà¦¾à¦² à¦•à¦°à§‡ à¦†à¦ªà¦¨à¦¾à¦° NAGAD à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦®à§‡à¦¨à§à¦¤à§‡ à¦¯à¦¾à¦¨ à¦…à¦¥à¦¬à¦¾ NAGAD à¦…à§à¦¯à¦¾à¦ªà§‡ à¦¯à¦¾à¦¨à¥¤</li>
                    <li><strong>Send Money</strong> - à¦ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨à¥¤</li>
                    <li>à¦ªà§à¦°à¦¾à¦ªà¦• à¦¨à¦®à§à¦¬à¦° à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦¨à¦¿à¦šà§‡à¦° à¦à¦‡ à¦¨à¦®à§à¦¬à¦°-à¦Ÿà¦¿ à¦²à¦¿à¦–à§à¦¨</li>
                </ul>
                <div class="deposit-number-box">
                    <span id="nagad-num-display" class="deposit-number-text">Loading...</span>
                    <button class="btn-copy-v2" onclick="copyToClipboard('nagad-num-display')">COPY</button>
                </div>
                <ul class="instruction-list">
                    <li>à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à¦¤à§‡ à¦à¦–à¦¨ à¦†à¦ªà¦¨à¦¾à¦° NAGAD à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦®à§‡à¦¨à§ à¦ªà¦¿à¦¨ à¦²à¦¿à¦–à§à¦¨à¥¤</li>
                    <li>à¦à¦–à¦¨ à¦‰à¦ªà¦°à§‡à¦° à¦¬à¦•à§à¦¸à§‡ à¦†à¦ªà¦¨à¦¾à¦° Transaction ID à¦¦à¦¿à¦¨ à¦à¦¬à¦‚ VERIFY à¦¬à¦¾à¦Ÿà¦¨à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨à¥¤</li>
                </ul>
                <button class="btn-verify-v2" onclick="verifyAutoPay('nagad')">VERIFY</button>
            </div>
        </div>
        
        <div id="content-rocket" class="payment-content-box">
            <div class="deposit-form-container rocket">
                <h3 class="deposit-form-title">à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦†à¦‡à¦¡à¦¿ à¦¦à¦¿à¦¨</h3>
                <input type="text" id="trx-rocket" class="deposit-form-input" placeholder="à¦à¦–à¦¾à¦¨à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦†à¦‡à¦¡à¦¿ à¦²à¦¿à¦–à§à¦¨">
                <ul class="instruction-list">
                    <li>*322# à¦¡à¦¾à§Ÿà¦¾à¦² à¦•à¦°à§‡ à¦†à¦ªà¦¨à¦¾à¦° Rocket à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦®à§‡à¦¨à§à¦¤à§‡ à¦¯à¦¾à¦¨ à¦…à¦¥à¦¬à¦¾ Rocket à¦…à§à¦¯à¦¾à¦ªà§‡ à¦¯à¦¾à¦¨à¥¤</li>
                    <li><strong>Send Money</strong> - à¦ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨à¥¤</li>
                    <li>à¦ªà§à¦°à¦¾à¦ªà¦• à¦¨à¦®à§à¦¬à¦° à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦¨à¦¿à¦šà§‡à¦° à¦à¦‡ à¦¨à¦®à§à¦¬à¦°-à¦Ÿà¦¿ à¦²à¦¿à¦–à§à¦¨</li>
                </ul>
                <div class="deposit-number-box">
                    <span id="rocket-num-display" class="deposit-number-text">Loading...</span>
                    <button class="btn-copy-v2" onclick="copyToClipboard('rocket-num-display')">COPY</button>
                </div>
                <ul class="instruction-list">
                    <li>à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à¦¤à§‡ à¦à¦–à¦¨ à¦†à¦ªà¦¨à¦¾à¦° Rocket à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦®à§‡à¦¨à§ à¦ªà¦¿à¦¨ à¦²à¦¿à¦–à§à¦¨à¥¤</li>
                    <li>à¦à¦–à¦¨ à¦‰à¦ªà¦°à§‡à¦° à¦¬à¦•à§à¦¸à§‡ à¦†à¦ªà¦¨à¦¾à¦° Transaction ID à¦¦à¦¿à¦¨ à¦à¦¬à¦‚ VERIFY à¦¬à¦¾à¦Ÿà¦¨à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨à¥¤</li>
                </ul>
                <button class="btn-verify-v2" onclick="verifyAutoPay('rocket')">VERIFY</button>
            </div>
        </div>
    </section>

    <!-- ========== WITHDRAW VIEW ========== -->
    <section id="withdraw-view" class="app-section">
        <div class="back-nav" onclick="navigateBack('wallet')">
            <i class="fas fa-arrow-left"></i>
            <span>WITHDRAW MONEY</span>
        </div>
        
        <div class="withdraw-container">
            <div class="withdraw-card balance-card">
                <img src="https://img.icons8.com/fluency/96/000000/wallet.png" alt="Wallet">
                <p style="font-weight: 700; color: var(--text-medium);">Available Winning Balance</p>
                <h2>à§³ <span id="withdraw-available">0</span></h2>
            </div>
            
            <div class="withdraw-card">
                <h4 style="font-weight: 900; margin-bottom: 20px;">Select Payment Method</h4>
                <div class="method-options">
                    <div class="method-btn active" onclick="selectWithdrawMethod(this, 'bKash')">
                        <img src="https://i.ibb.co.com/qF1xD5xj/image-search-1769091253468.png" alt="bKash">
                    </div>
                    <div class="method-btn" onclick="selectWithdrawMethod(this, 'Nagad')">
                        <img src="https://i.ibb.co/4gmdTj1f/image-search-1769091285966.png" alt="Nagad">
                    </div>
                    <div class="method-btn" onclick="selectWithdrawMethod(this, 'Rocket')">
                        <img src="https://i.ibb.co/MDt4TzDf/image-search-1769091463880.png" alt="Rocket">
                    </div>
                </div>
                <input type="hidden" id="withdraw-method" value="bKash">
            </div>
            
            <div class="withdraw-card">
                <h4 style="font-weight: 900; margin-bottom: 20px;">Withdrawal Details</h4>
                <div class="input-group-v2">
                    <i class="fas fa-mobile-alt"></i>
                    <input type="number" id="withdraw-number" placeholder="Mobile Number">
                </div>
                <div class="input-group-v2">
                    <i class="fas fa-coins"></i>
                    <input type="number" id="withdraw-amount" placeholder="Amount to Withdraw">
                </div>
            </div>
        </div>
        
        <div class="min-withdraw-notice">
            <i class="fas fa-info-circle"></i> MINIMUM WITHDRAW 100 TK
        </div>
        
        <button class="withdraw-submit-btn" onclick="submitWithdraw()">Withdraw Money</button>
    </section>

    <!-- ========== TRANSACTION HISTORY VIEW ========== -->
    <section id="history-view" class="app-section">
        <div class="back-nav" onclick="navigateBack('wallet')">
            <i class="fas fa-arrow-left"></i>
            <span>TRANSACTIONS</span>
        </div>
        <div id="history-list" style="padding: 20px;"></div>
    </section>

    <!-- ========== NOTIFICATIONS VIEW ========== -->
    <section id="notifications-view" class="app-section">
        <div class="back-nav" onclick="navigateBack('profile')">
            <i class="fas fa-arrow-left"></i>
            <span>NOTIFICATIONS</span>
        </div>
        <div id="notif-list-container" style="padding: 20px;"></div>
    </section>

    <!-- ========== REFER & EARN VIEW ========== -->
    <section id="refer-view" class="app-section">
        <div style="padding: 20px;">
            <div class="back-nav" onclick="navigateBack('profile')" style="margin: 0 0 20px 0;">
                <i class="fas fa-arrow-left"></i>
                <span>REFER & EARN</span>
            </div>
            
            <div class="glassmorphic" style="text-align: center;">
                <div style="margin-bottom: 20px;">
                    <img src="https://img.icons8.com/?size=100&id=mvX5rQmbiHy1&format=png&color=000000" style="width: 80px;">
                </div>
                <h2 style="color: var(--primary); font-weight: 900; margin-bottom: 10px;">Refer Your Friends</h2>
                <p style="color: var(--text-medium); margin-bottom: 30px;">Earn extra money by inviting your friends!</p>
                
                <div style="font-size: 0.8rem; font-weight: 800; color: var(--text-light); text-transform: uppercase; letter-spacing: 1px;">Your Referral Code</div>
                <div id="refer-code-display" class="refer-code-display">LOADING</div>
                
                <button class="primary-btn" onclick="copyReferralCode()">
                    <i class="fas fa-copy"></i> TAP TO COPY
                </button>
                
                <div class="refer-share-card" onclick="shareReferral()">
                    <span style="font-weight: 900; font-size: 1.1rem;">à¦¶à§‡à§Ÿà¦¾à¦° à¦•à¦°à§à¦¨</span>
                    <i class="fas fa-share-alt"></i>
                </div>
            </div>
            
            <div class="glassmorphic" style="margin-top: 20px; background: var(--secondary-gradient); color: white;">
                <h3 style="font-weight: 900; margin-bottom: 20px; text-align: center;">â¬‡ï¸ à¦…à§à¦¯à¦¾à¦ª à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡ à¦•à¦°à§à¦¨</h3>
                <div style="display: flex; gap: 15px; align-items: center; justify-content: center; flex-wrap: wrap;">
                    <a href="https://winningbd.app/download" target="_blank" style="background: white; padding: 14px 30px; border-radius: 50px; color: var(--secondary-dark); font-weight: 900; text-decoration: none;">
                        <i class="fas fa-download"></i> à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡
                    </a>
                    <button class="btn-copy-v2" onclick="copyText('https://winningbd.app/download')" style="background: white; color: var(--text-dark);">à¦•à¦ªà¦¿ à¦²à¦¿à¦‚à¦•</button>
                </div>
                <p style="margin-top: 15px; font-size: 0.8rem;">à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡ à¦²à¦¿à¦‚à¦•: https://winningbd.app/download</p>
            </div>
            
            <div id="update-banner-container" style="display: none;" class="update-banner">
                <span><i class="fas fa-sync-alt"></i> à¦¨à¦¤à§à¦¨ à¦­à¦¾à¦°à§à¦¸à¦¨ à¦‰à¦ªà¦²à¦¬à§à¦§</span>
                <button id="update-now-btn">à¦†à¦ªà¦¡à§‡à¦Ÿ</button>
            </div>
            
            <div style="margin-top: 30px;">
                <h4 style="font-weight: 900; margin-bottom: 20px;">HOW IT WORKS</h4>
                
                <div class="refer-step">
                    <div class="step-icon">
                        <i class="fas fa-share-alt"></i>
                    </div>
                    <div>
                        <div style="font-weight: 900; color: var(--text-dark);">1. Share Code</div>
                        <div style="font-size: 0.8rem; color: var(--text-medium);">Share your referral code with friends</div>
                    </div>
                </div>
                
                <div class="refer-step">
                    <div class="step-icon">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <div>
                        <div style="font-weight: 900; color: var(--text-dark);">2. Friend Joins</div>
                        <div style="font-size: 0.8rem; color: var(--text-medium);">Friend signs up using your code</div>
                    </div>
                </div>
                
                <div class="refer-step">
                    <div class="step-icon">
                        <i class="fas fa-gift"></i>
                    </div>
                    <div>
                        <div style="font-weight: 900; color: var(--text-dark);">3. Earn Reward</div>
                        <div style="font-size: 0.8rem; color: var(--text-medium);">You get 10 TK, Friend gets 5 TK</div>
                    </div>
                </div>
            </div>
            
            <span id="refer-cached-badge" class="cached-badge" style="display: none;">i à¦¡à¦¾à¦Ÿà¦¾</span>
        </div>
    </section>

    <!-- ========== EDIT PROFILE VIEW ========== -->
    <section id="edit-profile-view" class="app-section">
        <div style="padding: 20px;">
            <div class="back-nav" onclick="navigateBack('profile')" style="margin: 0 0 20px 0;">
                <i class="fas fa-arrow-left"></i>
                <span>EDIT PROFILE</span>
            </div>
            
            <div style="background: var(--bg-primary); border-radius: var(--radius-lg); padding: 30px; box-shadow: var(--shadow-neumorphic-sm);">
                <label style="font-weight: 900; font-size: 0.9rem; display: block; margin-bottom: 10px; color: var(--text-dark);">Full Name</label>
                <input type="text" id="edit-name" class="auth-input" placeholder="Enter your full name">
                
                <button class="primary-btn" onclick="saveProfile()" style="margin-top: 20px;">
                    UPDATE PROFILE
                </button>
            </div>
        </div>
    </section>

    <!-- ========== DEVELOPER PROFILE VIEW ========== -->
    <section id="developer-profile-view" class="app-section">
        <div style="padding: 20px;">
            <div class="back-nav" onclick="navigateBack('profile')" style="margin: 0 0 20px 0;">
                <i class="fas fa-arrow-left"></i>
                <span>DEVELOPER PROFILE</span>
            </div>
            
            <div class="dev-profile-card">
                <h2 class="dev-title">à¦Ÿà§à¦°à§à¦¨à¦¾à¦®à§‡à¦¨à§à¦Ÿ à¦…à§à¦¯à¦¾à¦ª à¦¬à¦¿à¦•à§à¦°à¦¿ à¦¹à¦šà§à¦›à§‡</h2>
                <p style="font-size: 1.1rem; margin-bottom: 30px; color: var(--text-dark); font-weight: 600;">à¦†à¦®à¦°à¦¾ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§‡ à¦¦à¦¿à¦šà§à¦›à¦¿ à¦†à¦ªà¦¨à¦¾à¦° à¦¨à¦¿à¦œà¦¸à§à¦¬ Android Tournament App à¦à¦¬à¦‚ Website Tournament Systemà¥¤</p>
                
                <ul class="dev-features">
                    <li><i class="fas fa-check-circle"></i> Automatic Payment System</li>
                    <li><i class="fas fa-check-circle"></i> Admin System</li>
                    <li><i class="fas fa-check-circle"></i> Moderator Panel</li>
                    <li><i class="fas fa-check-circle"></i> à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ à¦•à¦¾à¦¸à§à¦Ÿà¦® à¦¡à¦¿à¦œà¦¾à¦‡à¦¨</li>
                </ul>
                
                <p style="font-size: 1.2rem; font-weight: 900; margin-bottom: 30px; color: var(--text-dark);">â˜Žï¸ à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦•à¦°à¦¤à§‡ à¦¨à¦¿à¦šà§‡ ã€ŽDev Maimã€à¦¬à¦¾à¦Ÿà¦¨à§‡ à¦šà¦¾à¦ª à¦¦à¦¿à¦¨ !</p>
                
                <a href="https://t.me/cr_maim" target="_blank" class="dev-contact-btn">
                    ã€ŽDev Maimã€
                </a>
            </div>
        </div>
    </section>

    <!-- ========== MATCH RESULT DETAIL VIEW ========== -->
    <section id="match-result-detail" class="app-section">
        <div class="back-nav" onclick="showSection('result')">
            <i class="fas fa-arrow-left"></i>
            <span>Back</span>
        </div>
        <div id="result-details-container" style="padding: 20px;"></div>
    </section>
</main>

<!-- ========== BOTTOM NAVIGATION ========== -->
<div class="tab-bar">
    <div class="tab-item active" onclick="showSection('home')">
        <div class="tab-icon-box">
            <i class="fas fa-home"></i>
        </div>
        <span>Home</span>
    </div>
    <div class="tab-item" onclick="showSection('matches')">
        <div class="tab-icon-box">
            <i class="fas fa-trophy"></i>
        </div>
        <span>Matches</span>
    </div>
    <div class="tab-item" onclick="showSection('result')">
        <div class="tab-icon-box">
            <i class="fas fa-list-ul"></i>
        </div>
        <span>Result</span>
    </div>
    <div class="tab-item" onclick="showSection('profile')">
        <div class="tab-icon-box">
            <i class="fas fa-user"></i>
        </div>
        <span>Profile</span>
    </div>
</div>

<!-- ========== AUTH CONTAINER - FIXED UI ========== -->
<div id="auth-container">
    <!-- LOGIN PAGE -->
    <div id="login-page" class="auth-page active">
        <div class="auth-header">
            <div class="title">Welcome Back</div>
            <div class="subtitle">Sign in to your account</div>
        </div>
        
        <input type="email" id="login-email" class="auth-input" placeholder="Email Address">
        
        <div class="password-input-wrapper">
            <input type="password" id="login-pass" class="auth-input" placeholder="Password" style="margin-bottom: 0; box-shadow: none;">
            <span class="password-toggle-btn" onclick="togglePassword('login-pass', this)">
                <i class="fas fa-eye-slash"></i>
            </span>
        </div>
        <div id="login-error" class="auth-error-message"></div>
        
        <button class="auth-btn" id="login-btn" onclick="emailLogin()">Sign In</button>
        <div class="auth-link" onclick="showToast('Contact support to reset password', 'info')">à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦­à§à¦²à§‡ à¦—à§‡à¦²à§‡ à¦à¦–à¦¾à¦¨à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨</div>
        <div class="auth-switch-text">
            I'm a new user. <span onclick="switchAuthPage('signup')">Register</span>
        </div>
    </div>
    
    <!-- SIGNUP PAGE - FIXED UI -->
    <div id="signup-page" class="auth-page">
        <div class="auth-back-arrow" onclick="switchAuthPage('login')">
            <i class="fas fa-arrow-left"></i>
        </div>
        <div class="auth-header">
            <div class="title">Let's Start</div>
            <div class="subtitle">Create an account</div>
        </div>
        <div class="auth-form-title">Sign Up</div>
        
        <input type="text" id="reg-name" class="auth-input" placeholder="Full Name">
        <input type="email" id="reg-email" class="auth-input" placeholder="Email Address">
        <input type="number" id="reg-phone" class="auth-input" placeholder="Mobile Number">
        
        <div class="promo-group">
            <input type="text" id="reg-promo" class="auth-input" placeholder="à¦à¦¨à§à¦Ÿà¦¾à¦° à¦ªà§à¦°à§‹à¦®à§‹ à¦•à§‹à¦¡ (à¦…à¦ªà¦¶à¦¨à¦¾à¦²)" style="margin-bottom: 0;">
            <button type="button" class="promo-verify-btn" onclick="verifyPromoCode()">à¦­à§‡à¦°à¦¿à¦«à¦¾à¦‡</button>
        </div>
        <div id="promo-message"></div>
        
        <div class="password-input-wrapper">
            <input type="password" id="reg-pass" class="auth-input" placeholder="Password (min 6 characters)" style="margin-bottom: 0; box-shadow: none;">
            <span class="password-toggle-btn" onclick="togglePassword('reg-pass', this)">
                <i class="fas fa-eye-slash"></i>
            </span>
        </div>
        
        <div class="auth-checkbox-group">
            <input type="checkbox" id="terms-agree">
            <label for="terms-agree">I agree to the Terms and Conditions and Privacy Policy</label>
        </div>
        <div id="signup-error" class="auth-error-message"></div>
        
        <button class="auth-btn" id="register-btn" onclick="emailRegister()">Create Account</button>
        <div class="auth-switch-text">
            Already have an account? <span onclick="switchAuthPage('login')">Sign In</span>
        </div>
    </div>
</div>

<!-- ========== MODALS ========== -->
<div id="account-limit-modal" class="modal">
    <div class="modal-box">
        <div class="popup-close-btn" onclick="closeModal('account-limit-modal')">âœ•</div>
        <div style="text-align: center; padding: 15px;">
            <i class="fas fa-ban limit-icon"></i>
            <h3 style="color: var(--text-dark); margin-bottom: 10px; font-weight: 900;">à¦…à§à¦¯à¦¾à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦²à¦¿à¦®à¦¿à¦Ÿ!</h3>
            <p style="color: var(--text-medium); font-size: 1rem;">à¦†à¦ªà¦¨à¦¿ à¦¸à¦°à§à¦¬à§‹à¦šà§à¦š à§ªà¦Ÿà¦¿ à¦à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦–à§à¦²à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡à¦¨à¥¤</p>
        </div>
    </div>
</div>

<div id="join-warning-modal" class="modal">
    <div class="modal-box" style="text-align: center;">
        <i class="fas fa-info-circle" style="font-size: 3rem; color: var(--warning); margin-bottom: 20px;"></i>
        <h3 style="margin-bottom: 15px; color: var(--text-dark); font-weight: 900;">à¦®à§à¦¯à¦¾à¦šà§‡ à¦œà§Ÿà§‡à¦¨ à¦•à¦°à§à¦¨</h3>
        <p style="color: var(--text-medium); margin-bottom: 25px;">à¦†à¦ªà¦¨à¦¿ à¦à¦‡ à¦®à§à¦¯à¦¾à¦šà§‡ à¦œà§Ÿà§‡à¦¨ à¦•à¦°à§‡à¦¨à¦¨à¦¿</p>
        <div style="display: flex; gap: 15px; justify-content: center;">
            <button class="btn-details" onclick="closeModal('join-warning-modal')" style="flex: 1;">à¦ à¦¿à¦• à¦†à¦›à§‡</button>
            <button class="warning-join-btn" onclick="joinFromWarning()" style="flex: 1;">à¦œà§Ÿà§‡à¦¨ à¦¨à¦¾à¦“</button>
        </div>
    </div>
</div>

<div id="room-modal" class="modal">
    <div class="modal-box">
        <div class="popup-close-btn" onclick="closeModal('room-modal')">âœ•</div>
        <h3 style="font-weight: 900; text-align: center; margin-bottom: 30px;">ROOM DETAILS</h3>
        <div id="room-content-area" style="text-align: center;"></div>
    </div>
</div>

<div id="prize-modal" class="modal">
    <div class="modal-box">
        <div class="popup-close-btn" onclick="closeModal('prize-modal')">âœ•</div>
        <div style="background: var(--secondary-gradient); padding: 20px; border-radius: var(--radius-md); margin-bottom: 20px; text-align: center;">
            <div style="font-weight: 900; font-size: 1.3rem; color: white;">TOTAL WINPRIZE</div>
            <div id="prize-modal-subtitle" style="font-size: 0.9rem; color: rgba(255,255,255,0.9); margin-top: 5px;">Match Name</div>
        </div>
        <div id="prize-list-content"></div>
    </div>
</div>

<div id="join-modal" class="modal">
    <div class="modal-box">
        <div class="popup-close-btn" onclick="closeModal('join-modal')">âœ•</div>
        <h3 style="font-weight: 900; margin-bottom: 20px;">Join Match</h3>
        <div style="background: var(--bg-primary); padding: 15px; border-radius: var(--radius-md); margin-bottom: 20px; display: flex; justify-content: space-between; font-weight: 700; box-shadow: var(--shadow-neumorphic-inset-sm);">
            <span>Balance: <span id="join-curr-bal" style="color: var(--primary);">0</span> à§³</span>
            <span>Fee: <span id="join-req-fee">0</span> à§³</span>
        </div>
        <div id="join-inputs"></div>
        <button class="primary-btn" onclick="confirmJoin()" style="margin-top: 20px;">JOIN NOW</button>
    </div>
</div>

<div id="notice-modal" class="modal">
    <div class="modal-box">
        <div class="popup-close-btn" onclick="closeModal('notice-modal')">âœ•</div>
        <h3 id="notice-modal-title-display" style="font-weight: 900; margin-bottom: 20px; text-align: center;">Notice</h3>
        <div id="notice-modal-body" style="color: var(--text-dark); line-height: 1.6; margin-bottom: 25px;"></div>
        <button id="notice-modal-close-btn" class="primary-btn" onclick="closeModal('notice-modal')">OKAY</button>
    </div>
</div>

<!-- ========== FIREBASE AND APP SCRIPT - COMPLETE FIXED ========== -->
<script type="module">
    // =====================================================
    // FIREBASE CONFIGURATION - à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ à¦…à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¿à¦¤
    // =====================================================
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getDatabase, ref, set, onValue, push, update, get, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile as firebaseUpdateProfile } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCEmkD0u1ffyhajbH0t5Yea6qiTOBLnlTk",
        authDomain: "new-tournament-54705.firebaseapp.com",
        databaseURL: "https://new-tournament-54705-default-rtdb.firebaseio.com",
        projectId: "new-tournament-54705",
        storageBucket: "new-tournament-54705.firebasestorage.app",
        messagingSenderId: "409263106809",
        appId: "1:409263106809:web:7666f816a9264845ec1028",
        measurementId: "G-HS0XR5BJ9V"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const auth = getAuth(app);
    
    // ========== GLOBAL VARIABLES ==========
    let splashFinished = false;
    let currentUser = null;
    let currentUserData = null;
    let depositBal = 0;
    let winningBal = 0;
    let categories = {};
    let rawMatches = [];
    let userJoinedMatches = [];
    let currentActiveCategory = null;
    let currentMatchFilter = 'Upcoming';
    let currentJoinId = null;
    let currentEntryFee = 0;
    let videoLinks = { addMoney: '', getRoom: '', howPlay: '' };
    let supportLink = "https://t.me/cr_maim";
    let deviceId = localStorage.getItem('device_id') || 'device_' + Math.random().toString(36).substring(2) + Date.now();
    localStorage.setItem('device_id', deviceId);
    let verifiedPromoCode = null;
    const VALID_PROMOS = { 'WELCOME10': 10, 'WINNING5': 5, 'BONUS20': 20, 'FIRSTGAME': 5, 'NEWUSER': 5 };
    let lastActiveSection = 'home';
    
    // ========== NAVIGATION HISTORY & URL MANAGEMENT ==========
    const navHistory = []; // Stack for back navigation
    let ignorePopState = false; // Flag to prevent double handling

    // Update URL based on current section and sub-page (if any)
    function updateURL(section, subPage = null) {
        let pageParam = section;
        if (subPage && subPage !== section) {
            pageParam = subPage; // e.g., 'wallet'
        }
        const url = new URL(window.location);
        url.searchParams.set('page', pageParam);
        // Also set hash for backward compatibility
        url.hash = pageParam;
        window.history.pushState({ section: section, subPage: subPage }, '', url);
    }

    // Unified navigation function
    function navigateTo(section, subPage = null, addToHistory = true) {
        // Hide all sections first
        document.querySelectorAll('.app-section').forEach(el => el.classList.remove('active'));
        
        if (subPage) {
            // For sub pages, we activate the sub view
            const subView = document.getElementById(subPage + '-view');
            if (subView) {
                subView.classList.add('active');
                document.body.classList.add('sub-page');
            } else {
                // fallback to section
                document.getElementById('tab-' + section + '-view')?.classList.add('active');
                document.body.classList.remove('sub-page');
            }
        } else {
            // Main sections
            if (section === 'home') {
                document.getElementById('tab-home-view').classList.add('active');
                document.querySelectorAll('.tab-item').forEach((el, idx) => {
                    el.classList.toggle('active', idx === 0);
                });
            } else if (section === 'matches') {
                document.getElementById('tab-mymatches-view').classList.add('active');
                document.querySelectorAll('.tab-item').forEach((el, idx) => {
                    el.classList.toggle('active', idx === 1);
                });
                loadMyMatches();
            } else if (section === 'result') {
                document.getElementById('tab-result-view').classList.add('active');
                document.querySelectorAll('.tab-item').forEach((el, idx) => {
                    el.classList.toggle('active', idx === 2);
                });
                loadResults();
            } else if (section === 'profile') {
                document.getElementById('tab-profile-view').classList.add('active');
                document.querySelectorAll('.tab-item').forEach((el, idx) => {
                    el.classList.toggle('active', idx === 3);
                });
            }
            document.body.classList.remove('sub-page');
        }
        
        if (addToHistory) {
            navHistory.push({ section, subPage });
            updateURL(section, subPage);
        }
        lastActiveSection = section;
    }

    // Navigate back (used by back button and hardware back)
    function navigateBack() {
        if (navHistory.length > 1) {
            navHistory.pop(); // Remove current
            const prev = navHistory[navHistory.length - 1];
            ignorePopState = true;
            navigateTo(prev.section, prev.subPage, false); // false to not push again
            ignorePopState = false;
        } else {
            // If only home in history, show exit modal
            if (navHistory.length === 1 && navHistory[0].section === 'home') {
                showExitModal();
            } else {
                // Fallback to home
                navigateTo('home', null, true);
            }
        }
    }

    // Read page from URL on load
    function getPageFromURL() {
        const params = new URLSearchParams(window.location.search);
        let page = params.get('page');
        if (!page) {
            // Check hash
            const hash = window.location.hash.substring(1);
            if (hash) page = hash;
        }
        return page || 'home';
    }

    // Handle browser back/forward
    window.addEventListener('popstate', (event) => {
        if (ignorePopState) return;
        const page = getPageFromURL();
        // Determine if it's a sub page or main
        const subViews = ['wallet', 'add-money', 'withdraw', 'history', 'notifications', 'refer', 'edit-profile', 'developer-profile'];
        if (subViews.includes(page)) {
            navigateTo('profile', page, true);
        } else {
            navigateTo(page, null, true);
        }
    });

    // Android hardware back (and browser back) - handled by popstate

    // ========== EXIT CONFIRMATION MODAL ==========
    function showExitModal() {
        document.getElementById('exit-modal').classList.add('active');
    }
    window.closeExitModal = function() {
        document.getElementById('exit-modal').classList.remove('active');
    };
    window.exitAppConfirmed = function() {
        // Try to close the tab or go to home
        if (navigator.app && navigator.app.exitApp) {
            navigator.app.exitApp(); // For Cordova/WebView
        } else {
            window.close(); // May not work in all browsers
            // Fallback: go to blank page
            window.location.href = 'about:blank';
        }
    };

    // Override showSection to use navigateTo
    window.showSection = function(section) {
        navigateTo(section, null, true);
    };

    window.navigateSub = function(page) {
        navigateTo('profile', page, true);
    };

    window.navigateBack = function(from) {
        navigateBack();
    };

    // Fix: Category click now opens matches-view, not mymatches
    window.openCategory = function(categoryId) {
        currentActiveCategory = categoryId;
        // Show matches-view section
        document.querySelectorAll('.app-section').forEach(el => el.classList.remove('active'));
        document.getElementById('matches-view').classList.add('active');
        document.body.classList.add('sub-page');
        // Push to history
        navHistory.push({ section: 'matches', subPage: null });
        updateURL('matches', null);
        filterMatchTab('Upcoming');
    };

    // ========== NETWORK STATUS BAR ==========
    function showNetworkStatus() {
        const bar = document.getElementById('network-status-bar');
        if (bar) {
            bar.style.display = 'flex';
            bar.className = 'status-online';
            bar.innerHTML = '<i class="fas fa-wifi"></i> âœ“ à¦†à¦ªà¦¨à¦¿ à¦…à¦¨à¦²à¦¾à¦‡à¦¨à§‡ à¦†à¦›à§‡à¦¨ <span id="network-indicator-dot" class="network-indicator indicator-online"></span>';
            setTimeout(() => {
                bar.style.display = 'none';
            }, 4000);
        }
    }

    // ========== UTILITY FUNCTIONS ==========
    window.showToast = function(message, type = 'success') {
        const container = document.getElementById('toast-container');
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        let icon = type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-exclamation-triangle';
        toast.innerHTML = `<i class="fas ${icon}"></i><span>${message}</span>`;
        container.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
    };

    window.copyToClipboard = function(elementId) {
        const text = document.getElementById(elementId).innerText;
        navigator.clipboard.writeText(text);
        showToast('à¦•à¦ªà¦¿ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡', 'success');
    };

    window.copyText = function(text) {
        navigator.clipboard.writeText(text);
        showToast('à¦•à¦ªà¦¿ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡', 'success');
    };

    window.copyReferralCode = function() {
        const code = document.getElementById('refer-code-display').innerText;
        navigator.clipboard.writeText(code);
        showToast('Referral code copied!', 'success');
    };

    window.shareReferral = function() {
        const code = document.getElementById('refer-code-display').innerText;
        const text = `WINNING BD à¦ à¦œà§Ÿà§‡à¦¨ à¦•à¦°à§à¦¨! à¦†à¦®à¦¾à¦° à¦°à§‡à¦«à¦¾à¦°à§‡à¦² à¦•à§‹à¦¡: ${code}\nà¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡ à¦²à¦¿à¦‚à¦•: https://winningbd.app/download`;
        if (navigator.share) {
            navigator.share({ 
                title: 'WINNING BD', 
                text: text,
                url: 'https://winningbd.app/download'
            }).catch(() => {
                copyText(text);
                showToast('à¦²à¦¿à¦‚à¦• à¦•à¦ªà¦¿ à¦¹à§Ÿà§‡à¦›à§‡', 'success');
            });
        } else {
            copyText(text);
            showToast('à¦²à¦¿à¦‚à¦• à¦•à¦ªà¦¿ à¦¹à§Ÿà§‡à¦›à§‡', 'success');
        }
    };

    window.openVideo = function(type) {
        let url = '';
        if (type === 'addMoney') url = videoLinks.addMoney;
        if (type === 'getRoom') url = videoLinks.getRoom;
        if (type === 'howPlay') url = videoLinks.howPlay;
        if (url) window.open(url, '_blank');
        else showToast('Video link not available', 'error');
    };

    window.closeModal = function(modalId) {
        document.getElementById(modalId).classList.remove('active');
    };

    // ========== PASSWORD TOGGLE FUNCTION ==========
    window.togglePassword = function(inputId, element) {
        const input = document.getElementById(inputId);
        const icon = element.querySelector('i');
        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        } else {
            input.type = 'password';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        }
    };

    // ========== AUTHENTICATION FUNCTIONS - FIXED ==========
    window.showAuthScreen = function() {
        document.getElementById('auth-container').style.visibility = 'visible';
        switchAuthPage('login');
    };

    window.switchAuthPage = function(page) {
        document.getElementById('login-page').classList.remove('active');
        document.getElementById('signup-page').classList.remove('active');
        document.getElementById(page + '-page').classList.add('active');
        
        // Clear all errors
        document.querySelectorAll('.auth-error-message').forEach(el => {
            el.classList.remove('active');
            el.innerHTML = '';
        });
        document.querySelectorAll('.auth-input').forEach(el => {
            el.classList.remove('error');
        });
        document.getElementById('promo-message').innerHTML = '';
        verifiedPromoCode = null;
    };

    window.verifyPromoCode = function() {
        const code = document.getElementById('reg-promo').value.trim().toUpperCase();
        const messageDiv = document.getElementById('promo-message');
        
        if (!code) {
            messageDiv.innerHTML = '<span class="promo-error">âŒ à¦•à§‹à¦¡ à¦¦à¦¿à¦¨</span>';
            return;
        }
        if (VALID_PROMOS[code]) {
            verifiedPromoCode = { code, bonus: VALID_PROMOS[code] };
            messageDiv.innerHTML = `<span class="promo-success">âœ… à¦ªà§à¦°à§‹à¦®à§‹ à¦•à§‹à¦¡ à¦¸à¦«à¦²! à¦†à¦ªà¦¨à¦¿ ${VALID_PROMOS[code]} à¦Ÿà¦¾à¦•à¦¾ à¦¬à§‹à¦¨à¦¾à¦¸ à¦ªà¦¾à¦¬à§‡à¦¨</span>`;
            showToast('à¦ªà§à¦°à§‹à¦®à§‹ à¦•à§‹à¦¡ à¦¸à¦«à¦²!', 'success');
        } else {
            messageDiv.innerHTML = '<span class="promo-error">âŒ à¦•à§‹à¦¡ à¦‡à¦¨à¦­à§à¦¯à¦¾à¦²à¦¿à¦¡</span>';
            showToast('à¦•à§‹à¦¡ à¦‡à¦¨à¦­à§à¦¯à¦¾à¦²à¦¿à¦¡', 'error');
        }
    };

    window.emailLogin = async function() {
        const btn = document.getElementById('login-btn');
        const email = document.getElementById('login-email').value.trim();
        const password = document.getElementById('login-pass').value;
        const errorDiv = document.getElementById('login-error');
        
        // Clear previous errors
        errorDiv.classList.remove('active');
        errorDiv.innerHTML = '';
        document.getElementById('login-email').classList.remove('error');
        document.getElementById('login-pass').classList.remove('error');
        
        // Validation
        if (!email || !password) {
            errorDiv.innerHTML = 'à¦‡à¦®à§‡à¦‡à¦² à¦à¦¬à¦‚ à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦¦à¦¿à¦¨';
            errorDiv.classList.add('active');
            if (!email) document.getElementById('login-email').classList.add('error');
            if (!password) document.getElementById('login-pass').classList.add('error');
            return;
        }
        
        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> à¦²à¦—à¦‡à¦¨ à¦¹à¦šà§à¦›à§‡...';
        
        try {
            await signInWithEmailAndPassword(auth, email, password);
            showToast('à¦²à¦—à¦‡à¦¨ à¦¸à¦«à¦² à¦¹à¦¯à¦¼à§‡à¦›à§‡!', 'success');
            setTimeout(() => {
                document.getElementById('auth-container').style.visibility = 'hidden';
            }, 1000);
        } catch (error) {
            let errorMessage = '';
            switch(error.code) {
                case 'auth/user-not-found':
                    errorMessage = 'à¦à¦‡ à¦‡à¦®à§‡à¦‡à¦² à¦¦à¦¿à¦¯à¦¼à§‡ à¦•à§‹à¦¨à§‹ à¦à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦¨à§‡à¦‡';
                    document.getElementById('login-email').classList.add('error');
                    break;
                case 'auth/wrong-password':
                    errorMessage = 'à¦­à§à¦² à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡';
                    document.getElementById('login-pass').classList.add('error');
                    break;
                case 'auth/invalid-email':
                    errorMessage = 'à¦­à§à¦² à¦‡à¦®à§‡à¦‡à¦² à¦«à¦°à¦®à§à¦¯à¦¾à¦Ÿ';
                    document.getElementById('login-email').classList.add('error');
                    break;
                case 'auth/user-disabled':
                    errorMessage = 'à¦à¦‡ à¦à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦¨à¦¿à¦·à§à¦•à§à¦°à¦¿à¦¯à¦¼ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡';
                    break;
                default:
                    errorMessage = 'à¦²à¦—à¦‡à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤ à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨';
            }
            errorDiv.innerHTML = errorMessage;
            errorDiv.classList.add('active');
            showToast(errorMessage, 'error');
        } finally {
            btn.disabled = false;
            btn.innerHTML = 'Sign In';
        }
    };

    window.emailRegister = async function() {
        const btn = document.getElementById('register-btn');
        const name = document.getElementById('reg-name').value.trim();
        const email = document.getElementById('reg-email').value.trim();
        const phone = document.getElementById('reg-phone').value.trim();
        const password = document.getElementById('reg-pass').value;
        const terms = document.getElementById('terms-agree').checked;
        const errorDiv = document.getElementById('signup-error');
        
        // Clear previous errors
        errorDiv.classList.remove('active');
        errorDiv.innerHTML = '';
        document.querySelectorAll('#signup-page .auth-input').forEach(el => {
            el.classList.remove('error');
        });
        
        // Validation
        if (!name || !email || !phone || !password) {
            errorDiv.innerHTML = 'à¦¸à¦¬ à¦«à¦¿à¦²à§à¦¡ à¦ªà§‚à¦°à¦£ à¦•à¦°à§à¦¨';
            errorDiv.classList.add('active');
            if (!name) document.getElementById('reg-name').classList.add('error');
            if (!email) document.getElementById('reg-email').classList.add('error');
            if (!phone) document.getElementById('reg-phone').classList.add('error');
            if (!password) document.getElementById('reg-pass').classList.add('error');
            return;
        }
        
        if (password.length < 6) {
            errorDiv.innerHTML = 'à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦•à¦®à¦ªà¦•à§à¦·à§‡ à§¬ à¦…à¦•à§à¦·à¦°à§‡à¦° à¦¹à¦¤à§‡ à¦¹à¦¬à§‡';
            errorDiv.classList.add('active');
            document.getElementById('reg-pass').classList.add('error');
            return;
        }
        
        if (!terms) {
            errorDiv.innerHTML = 'à¦Ÿà¦¾à¦°à§à¦®à¦¸ à¦à¦¨à§à¦¡ à¦•à¦¨à§à¦¡à¦¿à¦¶à¦¨à¦¸ à¦—à§à¦°à¦¹à¦£ à¦•à¦°à§à¦¨';
            errorDiv.classList.add('active');
            return;
        }
        
        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦¹à¦šà§à¦›à§‡...';
        
        try {
            const userCredential = await createUserWithEmailAndPassword(auth, email, password);
            const user = userCredential.user;
            
            await firebaseUpdateProfile(user, { displayName: name });
            
            let bonus = 0;
            if (verifiedPromoCode) {
                bonus = verifiedPromoCode.bonus || 0;
            }
            
            await set(ref(db, 'users/' + user.uid), {
                username: name,
                email: email,
                phone: phone,
                deposit: bonus,
                winning: 0,
                created: serverTimestamp()
            });
            
            showToast(`à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦¸à¦«à¦²! à¦†à¦ªà¦¨à¦¿ ${bonus} à¦Ÿà¦¾à¦•à¦¾ à¦¬à§‹à¦¨à¦¾à¦¸ à¦ªà§‡à¦¯à¦¼à§‡à¦›à§‡à¦¨`, 'success');
            setTimeout(() => {
                document.getElementById('auth-container').style.visibility = 'hidden';
            }, 1500);
        } catch (error) {
            let errorMessage = '';
            switch(error.code) {
                case 'auth/email-already-in-use':
                    errorMessage = 'à¦à¦‡ à¦‡à¦®à§‡à¦‡à¦² à¦‡à¦¤à¦¿à¦®à¦§à§à¦¯à§‡ à¦¬à§à¦¯à¦¬à¦¹à§ƒà¦¤ à¦¹à¦šà§à¦›à§‡';
                    document.getElementById('reg-email').classList.add('error');
                    break;
                case 'auth/invalid-email':
                    errorMessage = 'à¦­à§à¦² à¦‡à¦®à§‡à¦‡à¦² à¦«à¦°à¦®à§à¦¯à¦¾à¦Ÿ';
                    document.getElementById('reg-email').classList.add('error');
                    break;
                case 'auth/weak-password':
                    errorMessage = 'à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦–à§à¦¬ à¦¸à¦¹à¦œ';
                    document.getElementById('reg-pass').classList.add('error');
                    break;
                default:
                    errorMessage = 'à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤ à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨';
            }
            errorDiv.innerHTML = errorMessage;
            errorDiv.classList.add('active');
            showToast(errorMessage, 'error');
        } finally {
            btn.disabled = false;
            btn.innerHTML = 'Create Account';
        }
    };

    window.logout = function() {
        signOut(auth).then(() => {
            showToast('à¦²à¦—à¦†à¦‰à¦Ÿ à¦¸à¦«à¦² à¦¹à¦¯à¦¼à§‡à¦›à§‡', 'success');
            document.getElementById('auth-container').style.visibility = 'visible';
            switchAuthPage('login');
        }).catch((error) => {
            showToast(error.message, 'error');
        });
    };

    // ========== AUTO REDIRECT - FIXED: SPLASH ALWAYS FIRST, THEN HOME OR LOGIN ==========
    onAuthStateChanged(auth, (user) => {
        if (user) {
            currentUser = user;
            
            // User is logged in -> after splash, show home and hide auth
            const waitForSplash = setInterval(() => {
                if (splashFinished) {
                    clearInterval(waitForSplash);
                    
                    document.getElementById('auth-container').style.visibility = 'hidden'; // hide login screen
                    document.getElementById('profile-login-btn').classList.add('hidden');
                    document.getElementById('profile-logout-btn').classList.remove('hidden');
                    
                    // Load initial page from URL or default to home
                    const initialPage = getPageFromURL();
                    navigateTo(initialPage, null, true);
                    
                    // Load user data
                    const userRef = ref(db, 'users/' + user.uid);
                    onValue(userRef, (snapshot) => {
                        const data = snapshot.val();
                        if (data) {
                            currentUserData = {
                                id: user.uid,
                                name: data.username || user.displayName,
                                email: data.email,
                                phone: data.phone,
                                deposit: data.deposit || 0,
                                winning: data.winning || 0
                            };
                            depositBal = data.deposit || 0;
                            winningBal = data.winning || 0;
                            
                            document.getElementById('profile-name').innerText = currentUserData.name || 'User';
                            document.getElementById('profile-email').innerText = currentUserData.email || '';
                            document.getElementById('profile-bal-dep').innerText = depositBal;
                            document.getElementById('profile-bal-win').innerText = winningBal;
                            document.getElementById('wallet-balance-display').innerText = depositBal + winningBal;
                            document.getElementById('deposit-available-wallet').innerText = depositBal;
                            document.getElementById('withdraw-available-wallet').innerText = winningBal;
                            document.getElementById('refer-code-display').innerText = user.uid.substring(0, 6).toUpperCase();
                        }
                    });
                }
            }, 100);
            
        } else {
            currentUser = null;
            currentUserData = null;
            depositBal = 0;
            winningBal = 0;
            
            // No user -> after splash, show auth container
            const waitForSplash = setInterval(() => {
                if (splashFinished) {
                    clearInterval(waitForSplash);
                    
                    document.getElementById('profile-name').innerText = 'Guest User';
                    document.getElementById('profile-email').innerText = 'Please login to continue';
                    document.getElementById('profile-bal-dep').innerText = '0';
                    document.getElementById('profile-bal-win').innerText = '0';
                    document.getElementById('profile-login-btn').classList.remove('hidden');
                    document.getElementById('profile-logout-btn').classList.add('hidden');
                    
                    // Show authentication screen
                    document.getElementById('auth-container').style.visibility = 'visible';
                    switchAuthPage('login');
                }
            }, 100);
        }
    });

    // ========== SPLASH SCREEN CONTROLLER ==========
    window.onload = function() {
        // à¦¸à§à¦ªà§à¦²à§à¦¯à¦¾à¦¶ à¦¸à§à¦•à§à¦°à¦¿à¦¨ 3.5 à¦¸à§‡à¦•à§‡à¦¨à§à¦¡ à¦¦à§‡à¦–à¦¾à¦¬à§‡
        setTimeout(() => {
            document.getElementById('splash-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('splash-screen').style.display = 'none';
                splashFinished = true;  // this triggers the auth state handler
            }, 500);
        }, 3500);
    };

    // ========== NETWORK & OFFLINE HANDLER ==========
    window.addEventListener('online', function() {
        document.getElementById('offline-page')?.classList.remove('active');
        const bar = document.getElementById('network-status-bar');
        if (bar) {
            bar.className = 'status-online';
            bar.innerHTML = '<i class="fas fa-wifi"></i> âœ“ à¦†à¦ªà¦¨à¦¿ à¦…à¦¨à¦²à¦¾à¦‡à¦¨à§‡ à¦†à¦›à§‡à¦¨ <span id="network-indicator-dot" class="network-indicator indicator-online"></span>';
            bar.style.display = 'flex';
            setTimeout(() => {
                bar.style.display = 'none';
            }, 4000);
        }
        showToast('Back online', 'success');
        if (lastActiveSection) showSection(lastActiveSection);
    });
    
    window.addEventListener('offline', function() {
        const bar = document.getElementById('network-status-bar');
        if (bar) {
            bar.className = 'status-offline';
            bar.innerHTML = '<i class="fas fa-wifi-slash"></i> âœ— à¦†à¦ªà¦¨à¦¿ offline (à¦¸à¦‚à¦¯à§‹à¦— à¦¨à§‡à¦‡) <span id="network-indicator-dot" class="network-indicator indicator-offline"></span>';
            bar.style.display = 'flex';
        }
        document.getElementById('offline-page')?.classList.add('active');
        showToast('You are offline', 'error');
    });

    // Initial check
    if (!navigator.onLine) {
        document.getElementById('offline-page')?.classList.add('active');
        const bar = document.getElementById('network-status-bar');
        if (bar) {
            bar.className = 'status-offline';
            bar.innerHTML = '<i class="fas fa-wifi-slash"></i> âœ— à¦†à¦ªà¦¨à¦¿ offline (à¦¸à¦‚à¦¯à§‹à¦— à¦¨à§‡à¦‡) <span class="network-indicator indicator-offline"></span>';
            bar.style.display = 'flex';
        }
    } else {
        showNetworkStatus();
    }

    // ========== WALLET FUNCTIONS ==========
    function updateWalletUI() {
        document.getElementById('wallet-balance-display').innerText = depositBal + winningBal;
        document.getElementById('deposit-available-wallet').innerText = depositBal;
        document.getElementById('withdraw-available-wallet').innerText = winningBal;
    }

    window.switchPayTab = function(method) {
        document.querySelectorAll('.pay-tab-v2').forEach(el => el.classList.remove('active'));
        document.querySelector(`.pay-tab-v2[onclick*="${method}"]`).classList.add('active');
        document.querySelectorAll('.payment-content-box').forEach(el => el.classList.remove('active'));
        document.getElementById(`content-${method}`).classList.add('active');
    };

    window.verifyAutoPay = async function(method) {
        if (!currentUser) {
            showAuthScreen();
            return;
        }
        const trxId = document.getElementById(`trx-${method}`).value.trim();
        if (!trxId) {
            showToast('Please enter Transaction ID', 'error');
            return;
        }
        try {
            const usedRef = ref(db, `Auto Pay/${trxId}`);
            const usedSnap = await get(usedRef);
            if (usedSnap.exists()) {
                showToast('This Transaction ID has already been used!', 'error');
                return;
            }
            const apiRef = ref(db, 'XNXANIKPAY');
            const apiSnap = await get(apiRef);
            let found = null;
            if (apiSnap.exists()) {
                Object.values(apiSnap.val()).forEach(p => {
                    if (p.txid && p.txid.toLowerCase() === trxId.toLowerCase()) {
                        found = p;
                    }
                });
            }
            if (found) {
                const amount = parseFloat(found.amount);
                await update(ref(db, 'users/' + currentUser.uid), {
                    deposit: depositBal + amount
                });
                await set(ref(db, `Auto Pay/${trxId}`), {
                    amount: amount,
                    usedBy: currentUser.uid,
                    time: serverTimestamp()
                });
                const txKey = push(ref(db, 'transactions/' + currentUser.uid)).key;
                await set(ref(db, 'transactions/' + currentUser.uid + '/' + txKey), {
                    type: 'Deposit',
                    amount: amount,
                    method: method,
                    status: 'Success',
                    txID: trxId,
                    date: new Date().toLocaleString()
                });
                showToast(`Successfully added ${amount} TK to your wallet!`, 'success');
                document.getElementById(`trx-${method}`).value = '';
                setTimeout(() => {
                    navigateSub('wallet');
                }, 1500);
            } else {
                showToast('Invalid Transaction ID. Please check again.', 'error');
            }
        } catch (error) {
            showToast(error.message, 'error');
        }
    };

    window.selectWithdrawMethod = function(element, method) {
        document.querySelectorAll('.method-btn').forEach(el => el.classList.remove('active'));
        element.classList.add('active');
        document.getElementById('withdraw-method').value = method;
    };

    window.submitWithdraw = async function() {
        if (!currentUser) {
            showAuthScreen();
            return;
        }
        const phone = document.getElementById('withdraw-number').value.trim();
        const amount = parseFloat(document.getElementById('withdraw-amount').value);
        const method = document.getElementById('withdraw-method').value;
        if (!phone || !amount) {
            showToast('Please fill all fields', 'error');
            return;
        }
        if (amount < 100) {
            showToast('Minimum withdraw amount is 100 TK', 'error');
            return;
        }
        if (amount > winningBal) {
            showToast('Insufficient winning balance', 'error');
            return;
        }
        try {
            const txKey = push(ref(db, 'transactions/' + currentUser.uid)).key;
            await set(ref(db, 'transactions/' + currentUser.uid + '/' + txKey), {
                type: 'Withdraw',
                amount: amount,
                number: phone,
                method: method,
                status: 'Pending',
                date: new Date().toLocaleString()
            });
            await update(ref(db, 'users/' + currentUser.uid), {
                winning: winningBal - amount
            });
            showToast('Withdrawal request submitted successfully!', 'success');
            document.getElementById('withdraw-number').value = '';
            document.getElementById('withdraw-amount').value = '';
            setTimeout(() => {
                navigateSub('wallet');
            }, 1500);
        } catch (error) {
            showToast(error.message, 'error');
        }
    };

    window.saveProfile = async function() {
        if (!currentUser) {
            showAuthScreen();
            return;
        }
        const name = document.getElementById('edit-name').value.trim();
        if (!name) {
            showToast('Please enter your name', 'error');
            return;
        }
        try {
            await firebaseUpdateProfile(currentUser, { displayName: name });
            await update(ref(db, 'users/' + currentUser.uid), { username: name });
            showToast('Profile updated successfully!', 'success');
            setTimeout(() => navigateBack('profile'), 1500);
        } catch (error) {
            showToast(error.message, 'error');
        }
    };

    // ========== MATCH FUNCTIONS ==========
    window.filterMatchTab = function(status) {
        currentMatchFilter = status;
        document.querySelectorAll('.m-tab').forEach(el => el.classList.remove('active'));
        const tabIndex = status === 'Upcoming' ? 0 : status === 'Ongoing' ? 1 : 2;
        document.querySelectorAll('.m-tab')[tabIndex].classList.add('active');
        const container = document.getElementById('matches-container');
        if (!container) return;
        let filteredMatches = rawMatches.filter(m => m.categoryId === currentActiveCategory && m.status === status);
        if (filteredMatches.length === 0) {
            container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-light); font-weight: 700;">No matches found</div>';
            return;
        }
        container.innerHTML = filteredMatches.map(match => createMatchCardHTML(match, status === 'Finished' ? 'result' : 'play')).join('');
    };

    function createMatchCardHTML(match, type) {
        const joined = match.joined || 0;
        const total = match.total || 48;
        const perc = (joined / total) * 100;
        const isJoined = userJoinedMatches.includes(match.id);
        const category = categories[match.categoryId];
        const categoryImg = category?.img || 'https://i.ibb.co.com/whcG0rC6/1770787659213-8d48fc16-a270-4efc-bbcd-e737bcbcd6c6.png';
        let actions = '';
        if (type === 'play') {
            if (isJoined) {
                actions = `
                    <div class="btn-details" onclick="checkRoom('${match.room_id}', '${match.room_pass}', '${match.dbKey}')">
                        <i class="fas fa-key"></i> Room Details
                    </div>
                    <button class="btn-join btn-joined" disabled>JOINED</button>
                `;
            } else {
                actions = `
                    <div class="btn-details" onclick="checkRoom('${match.room_id}', '${match.room_pass}', '${match.dbKey}')">
                        <i class="fas fa-key"></i> Room Details
                    </div>
                    <div class="btn-details" onclick="openPrizePool('${match.dbKey}')">
                        <i class="fas fa-trophy"></i> Prize Details
                    </div>
                    <button class="btn-join" onclick="prepJoin(${match.id}, '${match.type}', ${match.entry}, '${match.dbKey}')">Join</button>
                `;
            }
        } else if (type === 'joined') {
            actions = `
                <div class="btn-details" style="width: 100%;" onclick="checkRoom('${match.room_id}', '${match.room_pass}', '${match.dbKey}')">
                    <i class="fas fa-key"></i> Room ID & Password
                </div>
            `;
        } else {
            actions = `
                <div class="btn-details" style="width: 100%;" onclick="viewResult('${match.dbKey}')">
                    View Result
                </div>
            `;
        }
        return `
            <div class="match-card">
                <div class="mc-header">
                    <div style="position:relative;" class="mc-thumb-wrapper">
                        <img src="${categoryImg}" class="mc-thumb fade-image" data-cache-id="cat_${match.categoryId}">
                        <span class="badge-on-image cached-badge-img" style="display:none;">ðŸ‘ï¸</span>
                    </div>
                    <div class="mc-header-info">
                        <div class="mc-title">${match.title || 'Free Fire Match'}</div>
                        <div class="mc-time"><i class="far fa-clock"></i> ${match.time || 'Today at 8:00 PM'}</div>
                    </div>
                </div>
                <div class="mc-stats-grid">
                    <div class="mc-stat-box">
                        <div class="mc-stat-label">WIN PRIZE</div>
                        <div class="mc-stat-value">${match.total_prize || 1000} à§³</div>
                    </div>
                    <div class="mc-stat-box">
                        <div class="mc-stat-label">ENTRY TYPE</div>
                        <div class="mc-stat-value">${match.type || 'Solo'}</div>
                    </div>
                    <div class="mc-stat-box">
                        <div class="mc-stat-label">ENTRY FEE</div>
                        <div class="mc-stat-value">${match.entry || 20} à§³</div>
                    </div>
                    <div class="mc-stat-box">
                        <div class="mc-stat-label">PER KILL</div>
                        <div class="mc-stat-value">${match.per_kill || 10} à§³</div>
                    </div>
                    <div class="mc-stat-box">
                        <div class="mc-stat-label">MAP</div>
                        <div class="mc-stat-value">${match.map || 'Bermuda'}</div>
                    </div>
                    <div class="mc-stat-box">
                        <div class="mc-stat-label">VERSION</div>
                        <div class="mc-stat-value">MOBILE</div>
                    </div>
                </div>
                ${type !== 'result' ? `
                <div class="mc-progress-container">
                    <div class="mc-prog-bar">
                        <div class="mc-prog-fill" style="width: ${perc}%;"></div>
                    </div>
                    <div class="mc-spots-info">
                        <span>Only ${total - joined} spots are left</span>
                        <span>${joined}/${total}</span>
                    </div>
                </div>
                ` : ''}
                <div class="mc-btn-row">
                    ${actions}
                </div>
                ${type !== 'result' ? `
                <div class="mc-footer-timer match-countdown" data-time="${match.timestamp || Date.now() + 86400000}">
                    <i class="far fa-clock"></i> STARTS IN - Loading...
                </div>
                ` : ''}
            </div>
        `;
    }

    window.prepJoin = function(id, type, fee, key) {
        if (!currentUser) {
            showAuthScreen();
            return;
        }
        currentJoinId = id;
        currentEntryFee = fee;
        document.getElementById('join-curr-bal').innerText = depositBal + winningBal;
        let slots = 1;
        if (type && type.toLowerCase().includes('duo')) slots = 2;
        if (type && type.toLowerCase().includes('squad')) slots = 4;
        const container = document.getElementById('join-inputs');
        container.innerHTML = '';
        for (let i = 1; i <= slots; i++) {
            container.innerHTML += `<input type="text" class="auth-input" placeholder="Player ${i} Name" style="margin-bottom: 10px;">`;
        }
        document.getElementById('join-req-fee').innerText = fee * slots;
        document.getElementById('join-modal').querySelector('.primary-btn').dataset.key = key;
        document.getElementById('join-modal').classList.add('active');
    };

    window.confirmJoin = async function() {
        const inputs = document.querySelectorAll('#join-inputs input');
        let allFilled = true;
        let names = [];
        inputs.forEach(input => {
            if (!input.value.trim()) {
                allFilled = false;
                input.style.border = '2px solid var(--danger)';
            } else {
                names.push(input.value.trim());
            }
        });
        if (!allFilled) {
            showToast('Please fill all player names', 'error');
            return;
        }
        const totalFee = currentEntryFee * names.length;
        if (depositBal + winningBal < totalFee) {
            showToast('Insufficient balance', 'error');
            return;
        }
        const key = document.getElementById('join-modal').querySelector('.primary-btn').dataset.key;
        let newDeposit = depositBal;
        let newWinning = winningBal;
        let remaining = totalFee;
        if (newDeposit >= remaining) {
            newDeposit -= remaining;
        } else {
            remaining -= newDeposit;
            newDeposit = 0;
            newWinning -= remaining;
        }
        try {
            await update(ref(db, 'users/' + currentUser.uid), {
                deposit: newDeposit,
                winning: newWinning
            });
            for (let name of names) {
                await push(ref(db, 'match_participants/' + currentJoinId), {
                    ign: name,
                    joinedBy: currentUser.uid
                });
            }
            const matchRef = ref(db, 'matches/' + key);
            const snap = await get(matchRef);
            const currentJoined = snap.val()?.joined || 0;
            await update(matchRef, { joined: currentJoined + names.length });
            const txKey = push(ref(db, 'transactions/' + currentUser.uid)).key;
            await set(ref(db, 'transactions/' + currentUser.uid + '/' + txKey), {
                type: 'Match Join',
                amount: totalFee,
                method: 'Wallet',
                status: 'Success',
                date: new Date().toLocaleString()
            });
            showToast('Joined Successfully!', 'success');
            document.getElementById('join-modal').classList.remove('active');
        } catch (error) {
            showToast(error.message, 'error');
        }
    };

    window.checkRoom = function(roomId, roomPass, matchKey) {
        if (!currentUser) {
            showAuthScreen();
            return;
        }
        let isJoined = false;
        if (matchKey) {
            const match = rawMatches.find(m => m.dbKey === matchKey);
            if (match) {
                isJoined = userJoinedMatches.includes(match.id);
            }
        }
        const content = document.getElementById('room-content-area');
        if (isJoined) {
            content.innerHTML = `
                <div style="margin-bottom: 30px;">
                    <div style="font-size: 0.9rem; font-weight: 800; color: var(--text-light); margin-bottom: 10px;">ROOM ID</div>
                    <div style="font-size: 1.8rem; font-weight: 900; letter-spacing: 2px; padding: 15px; background: var(--bg-primary); border-radius: var(--radius-md); box-shadow: var(--shadow-neumorphic-inset-sm); margin-bottom: 15px;">
                        ${roomId || 'N/A'}
                    </div>
                    <button class="btn-copy-v2" onclick="copyText('${roomId}')" style="width: 100%;">COPY ROOM ID</button>
                </div>
                <div>
                    <div style="font-size: 0.9rem; font-weight: 800; color: var(--text-light); margin-bottom: 10px;">PASSWORD</div>
                    <div style="font-size: 1.8rem; font-weight: 900; letter-spacing: 2px; padding: 15px; background: var(--bg-primary); border-radius: var(--radius-md); box-shadow: var(--shadow-neumorphic-inset-sm); margin-bottom: 15px;">
                        ${roomPass || 'N/A'}
                    </div>
                    <button class="btn-copy-v2" onclick="copyText('${roomPass}')" style="width: 100%;">COPY PASSWORD</button>
                </div>
            `;
        } else {
            content.innerHTML = `
                <i class="fas fa-lock" style="font-size: 3rem; color: var(--danger); margin-bottom: 20px;"></i>
                <h3 style="font-weight: 900; margin-bottom: 15px; color: var(--danger);">ACCESS DENIED</h3>
                <p style="color: var(--text-medium); margin-bottom: 30px;">You have not joined this match yet. Please join the match first.</p>
                <button class="btn-join" onclick="closeModal('room-modal')" style="width: 100%;">OKAY</button>
            `;
        }
        document.getElementById('room-modal').classList.add('active');
    };

    window.joinFromWarning = function() {
        document.getElementById('join-warning-modal').classList.remove('active');
    };

    window.openPrizePool = function(key) {
        const match = rawMatches.find(m => m.dbKey === key);
        if (!match) return;
        document.getElementById('prize-modal-subtitle').innerText = match.title || 'Match';
        const content = document.getElementById('prize-list-content');
        if (match.prize_desc) {
            content.innerHTML = `<div style="line-height: 1.8;">${match.prize_desc.replace(/\n/g, '<br>')}</div>`;
        } else {
            const total = match.total_prize || 1000;
            const winner = Math.floor(total * 0.4);
            const second = Math.floor(total * 0.2);
            const third = Math.floor(total * 0.1);
            content.innerHTML = `
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <div style="display: flex; justify-content: space-between; padding: 15px; background: var(--bg-primary); border-radius: var(--radius-md); box-shadow: var(--shadow-neumorphic-inset-sm);">
                        <span style="font-weight: 800;">ðŸ‘‘ Winner</span>
                        <span style="font-weight: 900; color: var(--success);">${winner} à§³</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 15px; background: var(--bg-primary); border-radius: var(--radius-md); box-shadow: var(--shadow-neumorphic-inset-sm);">
                        <span style="font-weight: 800;">ðŸ¥ˆ 2nd Place</span>
                        <span style="font-weight: 900;">${second} à§³</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 15px; background: var(--bg-primary); border-radius: var(--radius-md); box-shadow: var(--shadow-neumorphic-inset-sm);">
                        <span style="font-weight: 800;">ðŸ¥‰ 3rd Place</span>
                        <span style="font-weight: 900;">${third} à§³</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 15px; background: var(--bg-primary); border-radius: var(--radius-md); box-shadow: var(--shadow-neumorphic-inset-sm);">
                        <span style="font-weight: 800;">ðŸ”¥ Per Kill</span>
                        <span style="font-weight: 900;">${match.per_kill || 10} à§³</span>
                    </div>
                </div>
            `;
        }
        document.getElementById('prize-modal').classList.add('active');
    };

    window.viewResult = function(key) {
        const match = rawMatches.find(m => m.dbKey === key);
        if (!match) return;
        document.getElementById('result-details-container').innerHTML = `
            <div class="match-card">
                <div class="mc-header">
                    <img src="${categories[match.categoryId]?.img || 'https://i.ibb.co.com/whcG0rC6/1770787659213-8d48fc16-a270-4efc-bbcd-e737bcbcd6c6.png'}" class="mc-thumb">
                    <div class="mc-header-info">
                        <div class="mc-title">${match.title}</div>
                        <div class="mc-time">${match.time}</div>
                    </div>
                </div>
                <div style="padding: 30px; text-align: center;">
                    <i class="fas fa-trophy" style="font-size: 3rem; color: gold; margin-bottom: 20px;"></i>
                    <h3 style="font-weight: 900; margin-bottom: 15px;">WINNER</h3>
                    <p style="font-size: 1.2rem; margin-bottom: 30px;">${match.winner || 'Not declared yet'}</p>
                    <button class="btn-details" onclick="showSection('result')" style="width: 100%;">BACK TO RESULTS</button>
                </div>
            </div>
        `;
        document.querySelectorAll('.app-section').forEach(el => el.classList.remove('active'));
        document.getElementById('match-result-detail').classList.add('active');
    };

    // ========== DATA LOAD FUNCTIONS ==========
    function loadMyMatches() {
        const container = document.getElementById('mymatches-container');
        if (!container) return;
        if (!currentUser) {
            container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-light); font-weight: 700;">Login to see matches</div>';
            return;
        }
        const myMatches = rawMatches.filter(m => userJoinedMatches.includes(m.id));
        if (myMatches.length === 0) {
            container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-light); font-weight: 700;">No joined matches</div>';
            return;
        }
        container.innerHTML = myMatches.map(match => createMatchCardHTML(match, 'joined')).join('');
    }

    function loadResults() {
        const container = document.getElementById('result-container');
        if (!container) return;
        const finishedMatches = rawMatches.filter(m => m.status === 'Finished');
        if (finishedMatches.length === 0) {
            container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-light); font-weight: 700;">No results yet</div>';
            return;
        }
        container.innerHTML = finishedMatches.map(match => createMatchCardHTML(match, 'result')).join('');
    }

    function loadHistory() {
        if (!currentUser) {
            document.getElementById('history-list').innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-light); font-weight: 700;">Please login to view transactions</div>';
            return;
        }
        const historyRef = ref(db, 'transactions/' + currentUser.uid);
        onValue(historyRef, (snapshot) => {
            const container = document.getElementById('history-list');
            const data = snapshot.val();
            if (!data) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-light); font-weight: 700;">No transactions found</div>';
                return;
            }
            let html = '';
            Object.values(data).reverse().forEach(t => {
                const isCredit = t.type && (t.type.includes('Deposit') || t.type.includes('Win'));
                const color = isCredit ? 'var(--success)' : 'var(--danger)';
                html += `
                    <div style="background: var(--bg-primary); border-radius: var(--radius-md); padding: 20px; margin-bottom: 15px; box-shadow: var(--shadow-neumorphic-sm);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span style="font-weight: 900;">${t.type || 'Transaction'}</span>
                            <span style="font-weight: 900; color: ${color};">${t.amount || 0} à§³</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="font-size: 0.8rem; color: var(--text-light);">${t.date || new Date().toLocaleString()}</span>
                            <span style="font-size: 0.8rem; padding: 4px 12px; background: ${t.status === 'Success' ? 'rgba(76,175,80,0.1)' : 'rgba(244,67,54,0.1)'}; color: ${t.status === 'Success' ? 'var(--success)' : 'var(--danger)'}; border-radius: 20px; font-weight: 700;">
                                ${t.status || 'Pending'}
                            </span>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }, { onlyOnce: true });
    }

    function loadNotifications() {
        const notifRef = ref(db, 'notifications');
        onValue(notifRef, (snapshot) => {
            const container = document.getElementById('notif-list-container');
            const data = snapshot.val();
            if (!data) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-light); font-weight: 700;">No notifications</div>';
                return;
            }
            let html = '';
            Object.values(data).reverse().forEach(n => {
                html += `
                    <div style="background: var(--bg-primary); border-radius: var(--radius-md); padding: 20px; margin-bottom: 15px; box-shadow: var(--shadow-neumorphic-sm);">
                        <div style="font-weight: 900; margin-bottom: 10px;">${n.title || 'Notification'}</div>
                        <div style="color: var(--text-medium);">${n.body || ''}</div>
                        <div style="font-size: 0.8rem; color: var(--text-light); margin-top: 10px;">${n.time || new Date().toLocaleString()}</div>
                    </div>
                `;
            });
            container.innerHTML = html;
            document.getElementById('menu-notif-badge').innerText = Object.keys(data).length;
            document.getElementById('menu-notif-badge').style.display = 'inline-block';
        });
    }

    // ========== FIREBASE LISTENERS ==========
    onValue(ref(db, 'categories'), (snapshot) => {
        const data = snapshot.val();
        if (data) {
            categories = data;
            const grid = document.getElementById('dynamic-category-list');
            grid.innerHTML = '';
            Object.entries(data).forEach(([key, cat]) => {
                const matchCount = rawMatches.filter(m => m.categoryId === key && m.status !== 'Finished').length;
                grid.innerHTML += `
                    <div class="cat-card" onclick="openCategory('${key}')">
                        <div style="position:relative;">
                            <img src="${cat.img || 'https://i.ibb.co.com/whcG0rC6/1770787659213-8d48fc16-a270-4efc-bbcd-e737bcbcd6c6.png'}" class="cat-card-img fade-image" data-cache-id="cat_${key}" alt="${cat.name}">
                            <span class="badge-on-image cached-badge-img" style="display:none;">ðŸ‘ï¸</span>
                        </div>
                        <div class="cat-card-info">
                            <div class="cat-card-title">${cat.name || 'Category'}</div>
                            <div class="cat-card-count" id="count-${key}">${matchCount} matches found</div>
                        </div>
                    </div>
                `;
            });
            setTimeout(() => { if (window.imageCache) window.imageCache.cacheAllImages(); }, 500);
        }
    });

    onValue(ref(db, 'matches'), (snapshot) => {
        rawMatches = [];
        const data = snapshot.val();
        if (data) {
            Object.entries(data).forEach(([key, val]) => {
                rawMatches.push({ dbKey: key, ...val });
            });
        }
        Object.keys(categories).forEach(key => {
            const count = rawMatches.filter(m => m.categoryId === key && m.status !== 'Finished').length;
            const el = document.getElementById(`count-${key}`);
            if (el) el.innerText = `${count} matches found`;
        });
        if (document.getElementById('matches-view').classList.contains('active')) {
            filterMatchTab(currentMatchFilter);
        }
        loadMyMatches();
        loadResults();
    });

    onValue(ref(db, 'match_participants'), (snapshot) => {
        if (!currentUser) return;
        userJoinedMatches = [];
        const data = snapshot.val();
        if (data) {
            Object.keys(data).forEach(matchId => {
                const participants = data[matchId];
                if (participants) {
                    Object.values(participants).forEach(p => {
                        if (p.joinedBy === currentUser.uid) {
                            userJoinedMatches.push(parseInt(matchId));
                        }
                    });
                }
            });
        }
        loadMyMatches();
    });

    onValue(ref(db, 'app_settings'), (snapshot) => {
        const data = snapshot.val();
        if (data) {
            // === FIXED MARQUEE: REAL-TIME DYNAMIC UPDATE ===
            if (data.notice) {
                const noticeEl = document.getElementById('dynamic-notice');
                if (noticeEl) {
                    noticeEl.innerText = data.notice;
                    // Force reflow to restart animation
                    noticeEl.style.animation = 'none';
                    noticeEl.offsetHeight; // trigger reflow
                    noticeEl.style.animation = 'marquee 25s linear infinite';
                }
            }
            
            if (data.bkash_number) document.getElementById('bkash-num-display').innerText = data.bkash_number;
            if (data.nagad_number) document.getElementById('nagad-num-display').innerText = data.nagad_number;
            if (data.rocket_number) document.getElementById('rocket-num-display').innerText = data.rocket_number;
            
            videoLinks = {
                addMoney: data.how_to_add_money_link || '',
                getRoom: data.how_to_get_room_id_link || '',
                howPlay: data.how_to_play_link || ''
            };
            
            if (data.support_link) supportLink = data.support_link;
            
            if (data.banners) {
                const slider = document.getElementById('banner-slider-wrapper');
                const dots = document.getElementById('slider-dots');
                slider.innerHTML = '';
                dots.innerHTML = '';
                
                let banners = [];
                if (Array.isArray(data.banners)) banners = data.banners;
                else if (typeof data.banners === 'object') banners = Object.values(data.banners);
                
                banners.forEach((b, i) => {
                    const clickAttr = b.link ? `onclick="window.open('${b.link}', '_blank')"` : '';
                    slider.innerHTML += `
                        <div class="slide" ${clickAttr}>
                            <img src="${b.img || 'https://i.ibb.co.com/whcG0rC6/1770787659213-8d48fc16-a270-4efc-bbcd-e737bcbcd6c6.png'}" class="fade-image" data-cache-id="banner_${i}">
                            <span class="badge-on-image cached-badge-img" style="display:none;">ðŸ‘ï¸</span>
                        </div>
                    `;
                    dots.innerHTML += `<div class="dot ${i === 0 ? 'active' : ''}"></div>`;
                });
                
                startSlider();
                setTimeout(() => { if (window.imageCache) window.imageCache.cacheAllImages(); }, 500);
            }
            
            if (data.popupNotice && data.popupNotice.enabled && data.popupNotice.body) {
                document.getElementById('notice-modal-title-display').innerText = data.popupNotice.title || 'Notice';
                document.getElementById('notice-modal-body').innerHTML = data.popupNotice.body.replace(/\n/g, '<br>');
                document.getElementById('notice-modal').classList.add('active');
            }
        }
    });

    // ========== IN-APP UPDATE SYSTEM ==========
    onValue(ref(db, 'app_settings/update_info'), (snapshot) => {
        const updateData = snapshot.val();
        if (updateData && updateData.link) {
            const banner = document.getElementById('update-banner-container');
            if (banner) banner.style.display = 'flex';
            const updateBtn = document.getElementById('update-now-btn');
            if (updateBtn) {
                updateBtn.onclick = () => window.open(updateData.link, '_blank');
            }
            if (updateData.forced === true) {
                document.getElementById('forced-update-overlay').style.display = 'flex';
                document.getElementById('forced-update-msg').innerText = updateData.message || 'à¦…à§à¦¯à¦¾à¦ª à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¾ à¦†à¦¬à¦¶à§à¦¯à¦•à¥¤';
                document.getElementById('forced-update-link').href = updateData.link;
            } else {
                document.getElementById('forced-update-overlay').style.display = 'none';
            }
        }
    });

    // ========== SLIDER ==========
    let slideIndex = 0;
    let slideInterval;
    function startSlider() {
        if (slideInterval) clearInterval(slideInterval);
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.dot');
        if (slides.length === 0) return;
        slideInterval = setInterval(() => {
            slideIndex = (slideIndex + 1) % slides.length;
            document.getElementById('banner-slider-wrapper').style.transform = `translateX(-${slideIndex * 100}%)`;
            dots.forEach(d => d.classList.remove('active'));
            if (dots[slideIndex]) dots[slideIndex].classList.add('active');
        }, 3000);
    }

    // ========== COUNTDOWN ==========
    setInterval(() => {
        document.querySelectorAll('.match-countdown').forEach(el => {
            const timestamp = parseInt(el.dataset.time);
            if (!timestamp) return;
            const diff = timestamp - Date.now();
            if (diff <= 0) {
                el.innerHTML = '<i class="far fa-clock"></i> MATCH STARTED';
            } else {
                const h = Math.floor(diff / 3600000);
                const m = Math.floor((diff % 3600000) / 60000);
                const s = Math.floor((diff % 60000) / 1000);
                el.innerHTML = `<i class="far fa-clock"></i> STARTS IN - ${h}h:${m}m:${s}s`;
            }
        });
    }, 1000);

    // ========== IMAGE CACHING SYSTEM WITH INDEXEDDB ==========
    class ImageCache {
        constructor() {
            this.dbName = 'WinningBDImageCache';
            this.storeName = 'images';
            this.db = null;
            this.initDB();
        }
        async initDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(this.dbName, 1);
                request.onerror = () => reject(request.error);
                request.onsuccess = () => {
                    this.db = request.result;
                    resolve();
                };
                request.onupgradeneeded = (e) => {
                    const db = e.target.result;
                    if (!db.objectStoreNames.contains(this.storeName)) {
                        db.createObjectStore(this.storeName, { keyPath: 'id' });
                    }
                };
            });
        }
        async getImage(id, url) {
            if (!this.db) await this.initDB();
            return new Promise((resolve) => {
                const tx = this.db.transaction(this.storeName, 'readonly');
                const store = tx.objectStore(this.storeName);
                const req = store.get(id);
                req.onsuccess = () => {
                    if (req.result) {
                        resolve({ blob: req.result.blob, cached: true });
                    } else {
                        fetch(url)
                            .then(res => res.blob())
                            .then(blob => {
                                const tx2 = this.db.transaction(this.storeName, 'readwrite');
                                const store2 = tx2.objectStore(this.storeName);
                                store2.put({ id, blob, timestamp: Date.now() });
                                resolve({ blob, cached: false });
                            })
                            .catch(() => resolve({ blob: null, cached: false }));
                    }
                };
                req.onerror = () => resolve({ blob: null, cached: false });
            });
        }
        async cacheAllImages() {
            const imgs = document.querySelectorAll('img[data-cache-id]');
            for (let img of imgs) {
                const id = img.dataset.cacheId;
                const url = img.src;
                const result = await this.getImage(id, url);
                if (result.blob) {
                    const objectUrl = URL.createObjectURL(result.blob);
                    img.src = objectUrl;
                    const parent = img.closest('.slide, .cat-card, .mc-header') || img.parentElement;
                    if (parent) {
                        const badge = parent.querySelector('.badge-on-image');
                        if (badge) badge.style.display = 'block';
                    }
                }
            }
        }
    }
    window.imageCache = new ImageCache();
    setTimeout(() => { if (window.imageCache) window.imageCache.cacheAllImages(); }, 1500);
</script>

<!-- ========== ENSURE CATEGORY GRID 2 COLUMNS ========== -->
<script>
    (function() {
        const style = document.createElement('style');
        style.innerHTML = `.category-grid { grid-template-columns: repeat(2, 1fr) !important; }`;
        document.head.appendChild(style);
    })();
</script>

</body>
</html>
